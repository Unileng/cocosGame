window.__require=function t(e,o,n){function i(r,c){if(!o[r]){if(!e[r]){var s=r.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+r+"'")}r=s}var u=o[r]={exports:{}};e[r][0].call(u.exports,function(t){return i(e[r][1][t]||t)},u,u.exports,t,e,o,n)}return o[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<n.length;r++)i(n[r]);return i}({AnimalChoose:[function(t,e,o){"use strict";cc._RF.push(e,"98cacqDxx1Cn5UNUVkSVhq6","AnimalChoose");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,o,r):i(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.target=null,e}return i(e,t),e.prototype.setTarget=function(t){this.target=t},e.prototype.update=function(){if(cc.isValid(this.target)){var t=this.target.parent.convertToWorldSpaceAR(this.target.position);t=this.node.parent.convertToNodeSpaceAR(t),this.node.position=t}},a([c],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],AnimalCube:[function(t,e,o){"use strict";cc._RF.push(e,"8dee9WqOmxE8pESL+BCs6FX","AnimalCube");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,o,r):i(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r},r=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(i,a){function r(t){try{s(n.next(t))}catch(e){a(e)}}function c(t){try{s(n.throw(t))}catch(e){a(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(r,c)}s((n=n.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var o,n,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(t){return function(e){return s([t,e])}}function s(a){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,n=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(6===a[0]&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],n=0}finally{o=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var s=t("../../Data/Enum"),l=t("../../Manager/EventManager"),u=t("../../Manager/PoolManager"),p=cc._decorator,h=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animalIcon=null,e.rigiBody=null,e.collider=null,e.animType=null,e.isChoose=!1,e.showSpriteFrame=null,e.lightSpriteFrame=null,e.outLineSpriteFrame=null,e}return i(e,t),e.prototype.onLoad=function(){this.rigiBody=this.node.getComponent(cc.RigidBody)},e.prototype.init=function(t,e){var o=this;this.node.scale=t,this.animType=e,cc.resources.load(s.ANIMAL_TYPE_TEXTUREURL[e],cc.SpriteFrame,function(t,e){t||(o.animalIcon.spriteFrame=e,o.showSpriteFrame=e)}),cc.resources.load(s.ANIMAL_TYPE_TEXTUREURL[e]+"_outline",cc.SpriteFrame,function(t,e){t||(o.outLineSpriteFrame=e)}),cc.resources.load(s.ANIMAL_TYPE_TEXTUREURL[e]+"_light",cc.SpriteFrame,function(t,e){t||(o.lightSpriteFrame=e)}),l.default.instance.on(s.ENUM_GAME_EVENT.GAME_BTN_JUMP_ITEM,this.jump,this),this.setChoose(!1)},e.prototype.showLight=function(){this.isChoose||(this.switchMaterial(!1),this.animalIcon.spriteFrame=this.lightSpriteFrame)},e.prototype.clearLight=function(){this.switchMaterial(!1),this.animalIcon.spriteFrame=this.showSpriteFrame},e.prototype.setChoose=function(t,e){return void 0===e&&(e=0),r(this,void 0,void 0,function(){return c(this,function(){return this.isChoose=t,[2]})})},e.prototype.chooseAni=function(){this.switchMaterial(),this.animalIcon.node.stopAllActions(),this.animalIcon.node.scale=1,cc.tween(this.animalIcon.node).to(.12,{scale:1.2},{easing:"cubicOut"}).to(.1,{scale:.9},{easing:"cubicInOut"}).to(.1,{scale:1},{easing:"bounceOut"}).call(function(){}).start()},e.prototype.switchMaterial=function(t){void 0===t&&(t=!0),t?(this.animalIcon.spriteFrame=this.outLineSpriteFrame,this.animalIcon.node.group="gameUI"):(this.animalIcon.spriteFrame=this.showSpriteFrame,this.animalIcon.node.group="animal")},e.prototype.getChooseType=function(){return this.isChoose},e.prototype.jump=function(){if(cc.isValid(this.rigiBody)){var t=Math.floor(1e6*(2*Math.random()-1));this.rigiBody.applyForce(cc.v2(t,1e6),this.rigiBody.getWorldCenter(),!0)}},e.prototype.remove=function(){u.default.instance.putNode(this.node,s.GAME_POOL.ANIMAL_POOL),this.animalIcon.spriteFrame=null,this.animType=null,this.isChoose=!1,l.default.instance.off(s.ENUM_GAME_EVENT.GAME_BTN_JUMP_ITEM,this.jump,this)},e.prototype.showLine=function(t,e,o,n){void 0===o&&(o=5),void 0===n&&(n=cc.Color.GREEN)},e.prototype.hideLine=function(){},a([d(cc.Sprite)],e.prototype,"animalIcon",void 0),a([h],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../Data/Enum":"Enum","../../Manager/EventManager":"EventManager","../../Manager/PoolManager":"PoolManager"}],AnimalManager:[function(t,e,o){"use strict";cc._RF.push(e,"c1901OG/hJAdJmWEqegNHiq","AnimalManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.getInstance=function(){return null===this._instance&&(this._instance=new this),this._instance},Object.defineProperty(t,"instance",{get:function(){return this.getInstance()},enumerable:!1,configurable:!0}),t._instance=null,t}();o.default=n,cc._RF.pop()},{}],DataManager:[function(t,e,o){"use strict";cc._RF.push(e,"fa4a9Ec1utAiJ+aaPeIEK5b","DataManager");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(i,a){function r(t){try{s(n.next(t))}catch(e){a(e)}}function c(t){try{s(n.throw(t))}catch(e){a(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(r,c)}s((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var o,n,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(t){return function(e){return s([t,e])}}function s(a){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,n=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(6===a[0]&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],n=0}finally{o=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.AnimalData=void 0;var a=t("../Data/Enum"),r=t("../Data/GameData"),c=t("../Manager/ResManager"),s="ANIMAL_LEVELDATA_",l=function(){function t(t){var e=cc.sys.localStorage.getItem(s+t);e?(e=JSON.parse(e),this._level=e.level,this._isLock=e.isLock,this._expValue=e.expValue,this._score=e.score):(this._level=1,this._isLock=!0,this._expValue=0,this._score=0)}return Object.defineProperty(t.prototype,"level",{get:function(){return this._level},set:function(t){this._level=t,this.save()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLock",{get:function(){return this._isLock},set:function(t){this._isLock=t,this.save()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"expValue",{get:function(){return this._expValue},set:function(t){this._expValue=t,this.save()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"score",{get:function(){return this._score},set:function(t){this._score=t,this.save()},enumerable:!1,configurable:!0}),t.prototype.save=function(){cc.sys.localStorage.setItem("STORAGE_KEY",JSON.stringify({level:this.level,isLock:this.isLock,expValue:this.expValue,score:this.score}))},t}();o.AnimalData=l;var u=function(){function t(){this._diamond=0,this._maxScore=0,this._useAnimId=0,this.animalData=[],this.toolData=[],this.currentUseToolID=-1}return t.getInstance=function(){return null===this._instance&&(this._instance=new this),this._instance},Object.defineProperty(t,"instance",{get:function(){return this.getInstance()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"diamond",{get:function(){return this._diamond},set:function(t){this._diamond=t,this.save()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxScore",{get:function(){return this._maxScore},set:function(t){this._maxScore=t,this.save()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useAnimId",{get:function(){return this._useAnimId},set:function(t){this._useAnimId=t,this.save()},enumerable:!1,configurable:!0}),t.prototype.save=function(){cc.sys.localStorage.setItem("STORAGE_KEY",JSON.stringify({diamond:this.diamond,maxScore:this.maxScore,useAnimId:this.useAnimId}))},t.prototype.init=function(t){return n(this,void 0,void 0,function(){var e,o;return i(this,function(n){switch(n.label){case 0:return e=this,[4,this.loadLocalAnimalData()];case 1:if(e.animalData=n.sent(),o=cc.sys.localStorage.getItem("STORAGE_KEY"))try{o=JSON.parse(o),this._diamond=o.diamond,this._maxScore=o.maxScore,this._useAnimId=o.useAnimId}catch(i){console.error("cc.sys.localStorage.getItem(STORAGE_KEY) error",i)}else this._diamond=0,this._maxScore=0,this.useAnimId=1;return this.loadLocalToolData(),this.currentUseToolID=-1,t&&t(),[2]}})})},t.prototype.getAnimalDataById=function(t){for(var e=0;e<this.animalData.length;e++)if(t==this.animalData[e].id)return this.animalData[e]},t.prototype.getToolDataById=function(t){for(var e=0;e<this.toolData.length;e++)if(t==this.toolData[e].id)return this.toolData[e]},t.prototype.loadLocalAnimalData=function(){return n(this,void 0,Promise,function(){var t,e,o,n,r;return i(this,function(i){switch(i.label){case 0:return[4,c.default.instance.loadRes(a.JsonUrl.animalJson)];case 1:for(t=i.sent(),e=[],o=0;o<t.json.length;o++)n=t.json[o],(r=new l(n.id)).id=n.id,r.desc=n.desc,r.lockMoney=n.lockMoney,r.name=n.name,e.push(r);return[2,e]}})})},t.prototype.loadLocalToolData=function(){this.toolData=[];for(var t=0;t<r.ToolDataLocal.length;t++){var e=r.ToolDataLocal[t],o={id:e[0],name:e[1],desc:e[2],diamondCost:e[3]};this.toolData.push(o)}},t._instance=null,t}();o.default=u,cc._RF.pop()},{"../Data/Enum":"Enum","../Data/GameData":"GameData","../Manager/ResManager":"ResManager"}],Enum:[function(t,e,o){"use strict";var n,i,a,r;cc._RF.push(e,"4a8b3BwkFpMBroR58wZ+RBe","Enum"),Object.defineProperty(o,"__esModule",{value:!0}),o.BaseScore=o.JsonUrl=o.GAME_Prefab=o.TOOL_TYPE_TEXTUREURL=o.TOOL_TYPE=o.ANIMAL_TYPE_TEXTUREURL=o.ANIMAL_TYPE=o.GAME_POOL=o.ENUM_GAME_EVENT=void 0,function(t){t.GAME_BTN_JUMP_ITEM="GAME_BTN_JUMP_ITEM",t.READYUI_CHOOSE_ITEM="READYUI_CHOOSE_ITEM",t.READYUI_CHOOSE_TOOLITEM="READYUI_CHOOSE_TOOLITEM",t.GAME_START="GAME_START"}(o.ENUM_GAME_EVENT||(o.ENUM_GAME_EVENT={})),function(t){t.ANIMAL_POOL="ANIMAL_POOL",t.ANIMAL_CHOOSE="ANIMAL_CHOOSE",t.ANIMAL_LINE="ANIMAL_LINE"}(o.GAME_POOL||(o.GAME_POOL={})),function(t){t[t.Bear=1]="Bear",t[t.Kitty=2]="Kitty",t[t.Frog=3]="Frog",t[t.Pengu=4]="Pengu",t[t.Fox=5]="Fox",t[t.Owl=6]="Owl",t[t.Rabbit=7]="Rabbit",t[t.Hippo=8]="Hippo",t[t.Piggy=9]="Piggy",t[t.Koala=10]="Koala",t[t.Duck=11]="Duck",t[t.Snake=12]="Snake"}(a=o.ANIMAL_TYPE||(o.ANIMAL_TYPE={})),o.ANIMAL_TYPE_TEXTUREURL=((n={})[a.Bear]="pic/animal/1",n[a.Kitty]="pic/animal/2",n[a.Frog]="pic/animal/3",n[a.Pengu]="pic/animal/4",n[a.Fox]="pic/animal/5",n[a.Owl]="pic/animal/6",n[a.Rabbit]="pic/animal/7",n[a.Hippo]="pic/animal/8",n[a.Piggy]="pic/animal/9",n[a.Koala]="pic/animal/10",n[a.Duck]="pic/animal/11",n[a.Snake]="pic/animal/12",n),function(t){t[t.SCORE=1]="SCORE",t[t.GEM=2]="GEM",t[t.BUBBLE=3]="BUBBLE",t[t.TIME=4]="TIME",t[t.FIVETOFOUR=5]="FIVETOFOUR"}(r=o.TOOL_TYPE||(o.TOOL_TYPE={})),o.TOOL_TYPE_TEXTUREURL=((i={})[r.SCORE]="pic/tools/1",i[r.GEM]="pic/tools/2",i[r.BUBBLE]="pic/tools/3",i[r.TIME]="pic/tools/4",i[r.FIVETOFOUR]="pic/tools/5",i),o.GAME_Prefab={mainBg:{zIndex:1,url:"prefab/UI/mainBgUI"},startUI:{zIndex:2,url:"prefab/UI/startUI"},readyUI:{zIndex:2,url:"prefab/UI/readyUI"},loadSceneUI:{zIndex:3,url:"prefab/UI/loadSceneUI"},animLine:"prefab/AnimalLine",animChoose:"prefab/AnimalChoose"},o.JsonUrl={animalJson:"jsons/animal"},o.BaseScore=10,cc._RF.pop()},{}],EventManager:[function(t,e,o){"use strict";cc._RF.push(e,"a65afuRIFJN0aWClIJ1OR72","EventManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this.eventMap=new Map}return t.getInstance=function(){return null===this._instance&&(this._instance=new this),this._instance},Object.defineProperty(t,"instance",{get:function(){return this.getInstance()},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,o){this.eventMap.has(t)?this.eventMap.get(t).push({event:e,context:o}):this.eventMap.set(t,[{event:e,context:o}])},t.prototype.off=function(t,e,o){if(this.eventMap.has(t)){var n=this.eventMap.get(t),i=n.findIndex(function(t){return t.event==e&&t.context==o});i>-1&&n.splice(i,1)}},t.prototype.emit=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];if(this.eventMap.has(t)){var n=this.eventMap.get(t);n.forEach(function(t){var o=t.event,n=t.context;n?o.apply(n,e):o(e)})}},t.prototype.clear=function(){this.eventMap.clear()},t._instance=null,t}();o.default=n,cc._RF.pop()},{}],GameData:[function(t,e,o){"use strict";cc._RF.push(e,"99616FD9LhHv76FPC2M4L7R","GameData"),Object.defineProperty(o,"__esModule",{value:!0}),o.ToolDataLocal=o.ToolTip=o.FactorLevelTsum=o.AnimalMaxLevel=o.BaseLevelScore=void 0,o.BaseLevelScore=5e3,o.AnimalMaxLevel=6,o.FactorLevelTsum=[80,76,70,55,74,72,78,67,64,61,58,52,49,46,43,36,32,28,40,24,20],o.ToolTip="\u82b1\u8d39\u5b9d\u77f3\u83b7\u5f97\u6e38\u620f\u4e2d\u5956\u52b1",o.ToolDataLocal=[[1,"+\u5206\u6570","\u5c06\u603b\u5206\u63d0\u9ad810%",200],[2,"+\u5b9d\u77f3","\u83b7\u5f9710%\u4ee5\u4e0a\u7684\u5b9d\u77f3",200],[3,"+\u6ce1\u6ce1","\u7b2c\u4e00\u6ce22\u4e2a\u6ce1\u6ce1\u5f00\u59cb\u6e38\u620f",200],[4,"+\u65f6\u95f4","\u4ee5+5\u79d2\u5f00\u59cb\u6e38\u620f",200],[5,"5-4","\u5168\u5c40\u53ea\u67094\u79cd\u52a8\u7269",800]],cc._RF.pop()},{}],GameUtils:[function(t,e,o){"use strict";cc._RF.push(e,"0826aHaRedL6IfAbOAfD5PH","GameUtils"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.formatNumber=function(t){if("number"!=typeof t)return"0";if(t<Math.pow(10,4))return String(t);var e=String(t/Math.pow(10,4));return e.substring(0,e.includes(".")?4:3).replace(/\.$/g,"")+"\u4e07"},t}();o.default=n,cc.Sprite.prototype.setSprite=function(t,e,o){var n=this;if(void 0===e&&(e=cc.resources),t){var i=e.get(t,cc.SpriteFrame);if(cc.isValid(i)){if(this.notDefaultSF)this.onReleaseSF();else{var a=this.onDestroy;this.onDestroy=function(){n.onReleaseSF(),a&&a.call(n)}}return this.spriteFrame=i,this.spriteFrame.addRef(),this.notDefaultSF=!0,void(o&&o())}e.load(t,cc.SpriteFrame,function(t,e){if(!t&&cc.isValid(n.node)){if(n.notDefaultSF)n.onReleaseSF();else{var i=n.onDestroy;n.onDestroy=function(){n.onReleaseSF(),i&&i.call(n)}}n.spriteFrame=e,n.spriteFrame.addRef(),n.notDefaultSF=!0,o&&o()}})}},cc.Sprite.prototype.onReleaseSF=function(){this.spriteFrame&&this.spriteFrame.refCount>0&&this.spriteFrame.decRef(),this.spriteFrame=null},cc._RF.pop()},{}],Game:[function(t,e,o){"use strict";cc._RF.push(e,"fb6d5Ze2YRPQY5gm5h//Lns","Game");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,o,r):i(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../Data/Enum"),c=t("../Manager/EventManager"),s=t("../Manager/PoolManager"),l=t("./AnimalCube/AnimalChoose"),u=t("./AnimalCube/AnimalCube"),p=cc._decorator,h=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bornAnimContainer=null,e.animChooseParent=null,e.animLineParent=null,e.animCube=null,e.touchNode=null,e.levelAnimal=[r.ANIMAL_TYPE.Bear,r.ANIMAL_TYPE.Kitty,r.ANIMAL_TYPE.Frog,r.ANIMAL_TYPE.Pengu],e.anims=[],e.selectedNodes=[],e.curTipNodes=[],e.minLinkCount=3,e.showMaxAnimal=30,e.animLine=null,e.animChoose=null,e}return i(e,t),e.prototype.onLoad=function(){var t=this;this.preLoadRes(),this.initData(),cc.director.getPhysicsManager().enabled=!0,cc.director.getCollisionManager().enabled=!0,this.schedule(function(){t.spawnGroup()},.5),this.touchNode.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.touchNode.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.touchNode.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.touchNode.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.preLoadRes=function(){cc.resources.preload(r.GAME_Prefab.animChoose,cc.Prefab),cc.resources.preload(r.GAME_Prefab.animLine,cc.Prefab)},e.prototype.initData=function(){this.animLine=new Map,this.animChoose=new Map,this.anims=[],this.selectedNodes=[],this.curTipNodes=[],this.bornAnimContainer.removeAllChildren(),this.animLineParent.removeAllChildren(),this.animChooseParent.removeAllChildren()},e.prototype.onBtnJump=function(){c.default.instance.emit(r.ENUM_GAME_EVENT.GAME_BTN_JUMP_ITEM)},e.prototype.spawnGroup=function(){var t=this;if(this.anims.length>this.showMaxAnimal)this.unscheduleAllCallbacks();else{for(var e=0;e<4;e++){var o=this.spawnAnimal(this.levelAnimal);o.name=this.anims.length+"",o.setPosition(cc.v2((Math.random()-.5)*(this.bornAnimContainer.width-60),0)),this.anims.push(o)}this.anims.length<this.showMaxAnimal&&this.scheduleOnce(function(){t.spawnGroup()},.5)}},e.prototype.spawnAnimal=function(t){var e=t[Math.floor(Math.random()*t.length)],o=s.default.instance.getNode(this.animCube,this.bornAnimContainer,r.GAME_POOL.ANIMAL_POOL);return o.angle=360*Math.random(),o.getComponent(u.default).init(1,e),o},e.prototype.onTouchStart=function(t){var e=this.getNodeUnderTouch(t);e&&this.addToSelection(e)},e.prototype.onTouchMove=function(t){var e=this.getNodeUnderTouch(t);if(e){var o=this.selectedNodes[this.selectedNodes.length-1];if(this.selectedNodes.length>1&&e.uuid===this.selectedNodes[this.selectedNodes.length-2].uuid)return this.removeFromSelection(o),void(this.selectedNodes.length>1&&e.getComponent(u.default).chooseAni());this.curTipNodes.includes(e)&&this.checkLineClear(e,o)&&!this.selectedNodes.includes(e)&&(this.addToSelection(e),e.getComponent(u.default).chooseAni())}},e.prototype.onTouchEnd=function(){this.clearLine(),this.selectedNodes.length>=this.minLinkCount?this.eliminateSelection():this.clearSelection(),this.clearTipsAnimCube()},e.prototype.getNodeUnderTouch=function(t){for(var e=t.getLocation(),o=null,n=0,i=this.anims;n<i.length;n++){var a=i[n];if(a){var r=a.convertToNodeSpaceAR(e),c=a.getComponent(cc.PhysicsCircleCollider).offset,s=a.getComponent(cc.PhysicsCircleCollider).radius;if(r.sub(c).mag()<=s){o=a;break}}}return o},e.prototype.clearSelection=function(){for(var t=0,e=this.selectedNodes;t<e.length;t++){var o=e[t];this.animChoose.has(o.uuid)&&(this.animChoose.get(o.uuid).getComponent(l.default).setTarget(null),s.default.instance.putNode(this.animChoose.get(o.uuid),r.GAME_POOL.ANIMAL_CHOOSE),this.animChoose.delete(o.uuid)),o.getComponent(u.default).setChoose(!1)}this.selectedNodes=[]},e.prototype.clearTipsAnimCube=function(){for(var t=0;t<this.curTipNodes.length;t++){var e=this.curTipNodes[t];cc.isValid(e)&&e.getComponent(u.default).clearLight()}this.curTipNodes=[]},e.prototype.addTipsAnimCube=function(t){this.curTipNodes=this.getGraphGroup(t,this.anims);for(var e=0;e<this.curTipNodes.length;e++){var o=this.curTipNodes[e];cc.isValid(o)&&o.getComponent(u.default).showLight()}},e.prototype.eliminateSelection=function(){for(var t=function(t){e.animChoose.has(t.uuid)&&(e.animChoose.get(t.uuid).getComponent(l.default).setTarget(null),s.default.instance.putNode(e.animChoose.get(t.uuid),r.GAME_POOL.ANIMAL_CHOOSE),e.animChoose.delete(t.uuid)),e.anims=e.anims.filter(function(e){return e.uuid!=t.uuid}),t.getComponent(u.default).remove()},e=this,o=0,n=this.selectedNodes;o<n.length;o++)t(n[o]);this.selectedNodes=[],this.spawnGroup()},e.prototype.addToSelection=function(t){var e=this;this.selectedNodes.length>1&&this.selectedNodes[this.selectedNodes.length-1].getComponent(u.default).switchMaterial(!1),this.selectedNodes.push(t),this.drawLine(),t.getComponent(u.default).setChoose(!0),this.animChoose.has(t.uuid)?(this.animChoose.get(t.uuid).active=!0,this.animChoose.get(t.uuid).setPosition(t.position)):cc.resources.load(r.GAME_Prefab.animChoose,cc.Prefab,function(o,n){if(!o){var i=s.default.instance.getNode(n,e.animChooseParent,r.GAME_POOL.ANIMAL_CHOOSE);e.animChoose.set(t.uuid,i),i.getComponent(l.default).setTarget(t)}}),this.clearTipsAnimCube(),this.addTipsAnimCube(t)},e.prototype.removeFromSelection=function(t){this.selectedNodes.pop(),t.getComponent(u.default).setChoose(!1),this.animChoose.has(t.uuid)&&(this.animChoose.get(t.uuid).getComponent(l.default).setTarget(null),s.default.instance.putNode(this.animChoose.get(t.uuid),r.GAME_POOL.ANIMAL_CHOOSE),this.animChoose.delete(t.uuid)),this.clearTipsAnimCube(),this.selectedNodes.length>0&&this.addTipsAnimCube(this.selectedNodes[this.selectedNodes.length-1]),this.drawLine()},e.prototype.findCanClear=function(){var t=this.anims;this.findConnectedSameType(t,3).length},e.prototype.findConnectedSameType=function(t,e){for(var o={},n=0,i=t;n<i.length;n++)o[r=(y=i[n]).getComponent(u.default).animType]||(o[r]=[]),o[r].push(y);var a=[];for(var r in o){for(var c=o[r],s={},l=0;l<c.length;l++){s[c[l].uuid]=[];for(var p=0;p<c.length;p++)l!==p&&this.checkLineClear(c[l],c[p])&&!c[p].getComponent(u.default).getChooseType()&&s[c[l].uuid].push(c[p])}for(var h=new Set,d=0,f=c;d<f.length;d++){var y=f[d];if(!h.has(y.uuid)){var m=[];if(this.dfs(y,s,h,m),m.length>e)return m}}}return a},e.prototype.getGraphGroup=function(t,e){for(var o={},n=0,i=e;n<i.length;n++){var a=i[n],r=a.getComponent(u.default).animType;o[r]||(o[r]=[]),o[r].push(a)}for(var c=o[t.getComponent(u.default).animType],s={},l=0;l<c.length;l++){s[c[l].uuid]=[];for(var p=0;p<c.length;p++)l!==p&&this.checkLineClear(c[l],c[p])&&!c[p].getComponent(u.default).getChooseType()&&s[c[l].uuid].push(c[p])}var h=new Set,d=[];return this.dfs(t,s,h,d),d},e.prototype.dfs=function(t,e,o,n){o.add(t.uuid),n.push(t);for(var i=0,a=e[t.uuid];i<a.length;i++){var r=a[i];o.has(r.uuid)||this.dfs(r,e,o,n)}},e.prototype.checkLineClear=function(t,e){for(var o=cc.director.getPhysicsManager(),n=t.convertToWorldSpaceAR(cc.v2(0,0)),i=e.convertToWorldSpaceAR(cc.v2(0,0)),a=0,r=o.rayCast(n,i,cc.RayCastType.All);a<r.length;a++){var c=r[a].collider.node;if(c!==t&&c!==e)return!1}return!0},e.prototype.drawLine=function(t){var e=this;if(void 0===t&&(t=cc.Color.WHITE),this.selectedNodes.length<2)this.clearLine();else{this.clearLine();for(var o=function(o){var i=n.selectedNodes[o],a=n.selectedNodes[o+1],c=cc.v2(i.position),l=cc.v2(a.position),p=c.sub(l),h=Math.atan2(p.y,p.x),d=cc.misc.radiansToDegrees(h),f=p.mag();if(i.getComponent(u.default).showLine(d,f),n.animLine.has(a.uuid)){var y=n.animLine.get(a.uuid),m=i.parent.convertToWorldSpaceAR(i.position);m=n.animLineParent.convertToNodeSpaceAR(m),y.setPosition(m),y.angle=0,y.angle=d,y.width=f,y.color=t,y.active=!0,n.animLine.set(a.uuid,y)}else cc.resources.load(r.GAME_Prefab.animLine,cc.Prefab,function(o,n){if(!o){var c=s.default.instance.getNode(n,e.animLineParent,r.GAME_POOL.ANIMAL_LINE);c.angle=0;var l=i.parent.convertToWorldSpaceAR(i.position);l=e.animLineParent.convertToNodeSpaceAR(l),c.setPosition(l),c.angle=d,c.width=f,c.color=t,c.active=!0,e.animLine.set(a.uuid,c)}})},n=this,i=0;i<this.selectedNodes.length-1;i++)o(i)}},e.prototype.clearLine=function(){this.animLine.size>0&&(this.animLine.forEach(function(t){s.default.instance.putNode(t,r.GAME_POOL.ANIMAL_LINE)}),this.animLine.clear())},e.prototype.getScore=function(){},a([d(cc.Node)],e.prototype,"bornAnimContainer",void 0),a([d(cc.Node)],e.prototype,"animChooseParent",void 0),a([d(cc.Node)],e.prototype,"animLineParent",void 0),a([d(cc.Prefab)],e.prototype,"animCube",void 0),a([d(cc.Node)],e.prototype,"touchNode",void 0),a([h],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../Data/Enum":"Enum","../Manager/EventManager":"EventManager","../Manager/PoolManager":"PoolManager","./AnimalCube/AnimalChoose":"AnimalChoose","./AnimalCube/AnimalCube":"AnimalCube"}],LoadSceneUI:[function(t,e,o){"use strict";cc._RF.push(e,"8de70Kr0zRIqIQNzKg0X8eI","LoadSceneUI");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,o,r):i(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.logo=null,e.catchNode=null,e.endCB=null,e}return i(e,t),e.prototype.onLoad=function(){this.loadAni(),cc.game.addPersistRootNode(this.node)},e.prototype.loadAni=function(){var t=this;this.logo.stopAllActions(),this.catchNode.stopAllActions();var e=.5*cc.winSize.height+300;this.logo.setPosition(cc.v3(0,e)),this.catchNode.setPosition(cc.v3(0,e+370)),cc.tween(this.logo).to(.5,{y:200},{easing:"quadIn"}).delay(1.2).to(.5,{y:e}).start(),cc.tween(this.catchNode).delay(.7).to(.5,{y:570},{easing:"quadIn"}).call(function(){cc.isValid(t.catchNode)&&cc.isValid(t.catchNode.getComponent(cc.Animation))&&t.catchNode.getComponent(cc.Animation).play("catch")}).delay(.5).to(.5,{y:e+370}).call(function(){t.endCB&&t.endCB(),t.node.destroy()}).start()},a([s(cc.Node)],e.prototype,"logo",void 0),a([s(cc.Node)],e.prototype,"catchNode",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],MainBgUI:[function(t,e,o){"use strict";cc._RF.push(e,"2f1bc0V1QNLLaL8heMVfmeY","MainBgUI");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,o,r):i(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.yunLeft=null,e.yunRight=null,e}return i(e,t),e.prototype.onLoad=function(){this.yunAni()},e.prototype.yunAni=function(){this.yunLeft.stopAllActions(),this.yunRight.stopAllActions();var t=.5*cc.winSize.height-100,e=.5*cc.winSize.height-200;this.yunLeft.y=t,this.yunRight.y=t,cc.tween(this.yunLeft).repeatForever(cc.tween().to(10,{y:e}).to(10,{y:t})).start(),cc.tween(this.yunRight).repeatForever(cc.tween().to(10,{y:e}).to(10,{y:t})).start()},a([s(cc.Node)],e.prototype,"yunLeft",void 0),a([s(cc.Node)],e.prototype,"yunRight",void 0),a([c],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],Main:[function(t,e,o){"use strict";cc._RF.push(e,"66a689LYaRFJKskQx/Xo19r","Main");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,o,r):i(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../Data/Enum"),c=t("../Manager/EventManager"),s=t("../Manager/ResManager"),l=t("./DataManager"),u=t("./UI/LoadSceneUI"),p=t("./UI/ReadyUI"),h=t("./UI/StartUI"),d=cc._decorator,f=d.ccclass,y=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loadUI=null,e}return i(e,t),e.prototype.onLoad=function(){this.reloadRes(),c.default.instance.on(r.ENUM_GAME_EVENT.GAME_START,this.toGame,this)},e.prototype.reloadRes=function(){var t=this;this.loadingAni();var e=!1,o=!1,n=!1;cc.resources.preload([r.GAME_Prefab.mainBg.url,r.GAME_Prefab.startUI.url,r.GAME_Prefab.readyUI.url,r.GAME_Prefab.loadSceneUI.url,r.JsonUrl.animalJson],function(){},function(){e=!0,t.checkLogin(e,o,n)}),cc.director.preloadScene("game",function(){},function(){o=!0,t.checkLogin(e,o,n)}),l.default.instance.init(function(){n=!0,t.checkLogin(e,o,n)})},e.prototype.checkLogin=function(t,e,o){t&&e&&o&&(this.stopLoading(),this.startMain())},e.prototype.startMain=function(){var t=this;s.default.instance.loadRes(r.GAME_Prefab.mainBg.url).then(function(e){var o=cc.instantiate(e);o.parent=t.node,o.zIndex=r.GAME_Prefab.mainBg.zIndex}),s.default.instance.loadRes(r.GAME_Prefab.startUI.url).then(function(e){var o=cc.instantiate(e);o.parent=t.node,o.zIndex=r.GAME_Prefab.startUI.zIndex,o.getComponent(h.default).onAwake(),o.getComponent(h.default).quitCB=t.toReadyUI.bind(t)})},e.prototype.toReadyUI=function(){var t=this;s.default.instance.loadRes(r.GAME_Prefab.readyUI.url).then(function(e){var o=cc.instantiate(e);o.parent=t.node,o.zIndex=r.GAME_Prefab.readyUI.zIndex,o.getComponent(p.default).onAwake()})},e.prototype.toGame=function(){var t=this;c.default.instance.off(r.ENUM_GAME_EVENT.GAME_START,this.toGame,this),s.default.instance.loadRes(r.GAME_Prefab.loadSceneUI.url).then(function(e){var o=cc.instantiate(e);o.parent=t.node,o.zIndex=r.GAME_Prefab.loadSceneUI.zIndex,o.getComponent(u.default).endCB=function(){cc.director.loadScene("game"),cc.resources.releaseAll()}})},e.prototype.loadingAni=function(){this.loadUI.active=!0;var t=this.loadUI.getChildByName("1"),e=this.loadUI.getChildByName("2");t.stopAllActions,e.stopAllActions,cc.tween(t).repeatForever(cc.tween().to(2,{angle:180}).to(2,{angle:360}).to(0,{angle:0})).start(),cc.tween(e).repeatForever(cc.tween().to(2,{angle:-180}).to(2,{angle:-360}).to(0,{angle:0})).start()},e.prototype.stopLoading=function(){this.loadUI.active=!1;var t=this.loadUI.getChildByName("1"),e=this.loadUI.getChildByName("2");t.stopAllActions,e.stopAllActions},a([y(cc.Node)],e.prototype,"loadUI",void 0),a([f],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../Data/Enum":"Enum","../Manager/EventManager":"EventManager","../Manager/ResManager":"ResManager","./DataManager":"DataManager","./UI/LoadSceneUI":"LoadSceneUI","./UI/ReadyUI":"ReadyUI","./UI/StartUI":"StartUI"}],PoolManager:[function(t,e,o){"use strict";cc._RF.push(e,"63c79rdzlpPLK5nZD81cOq2","PoolManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this.dictPool=new Map}return t.getInstance=function(){return null===this._instance&&(this._instance=new this),this._instance},Object.defineProperty(t,"instance",{get:function(){return this.getInstance()},enumerable:!1,configurable:!0}),t.prototype.getNode=function(t,e,o){void 0===o&&(o="default");var n=null;if(this.dictPool.has(o))n=(i=this.dictPool.get(o)).size()>0?i.get():cc.instantiate(t);else{var i=new cc.NodePool;this.dictPool.set(o,i),n=cc.instantiate(t)}return n.parent=e,n},t.prototype.putNode=function(t,e){void 0===e&&(e="default");var o=null;this.dictPool.has(e)?o=this.dictPool.get(e):(o=new cc.NodePool,this.dictPool.set(e,o)),o.put(t)},t.prototype.clearPool=function(t){if(t){var e=this.dictPool.get(t);e&&e.clear(),this.dictPool.delete(t)}else cc.warn("PoolManager.clearPool: name is null")},t.prototype.clearAll=function(){this.dictPool.forEach(function(t){t.clear()}),this.dictPool.clear()},t._instance=null,t}();o.default=n,cc._RF.pop()},{}],ReadyAnimalItem:[function(t,e,o){"use strict";cc._RF.push(e,"26f66lc8cVIto3S93XIK1Wx","ReadyAnimalItem");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,o,r):i(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../Data/Enum"),c=t("../../../Manager/EventManager"),s=cc._decorator,l=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.progressSpr=null,e.chooseNode=null,e.lock=null,e.cost=null,e.lvLabel=null,e.id=0,e}return i(e,t),e.prototype.init=function(t){var e=t.lockMoney>0&&t.isLock,o=r.ANIMAL_TYPE_TEXTUREURL[t.id]+(e?"_lock":"");this.lock.active=e,c.default.instance.on(r.ENUM_GAME_EVENT.READYUI_CHOOSE_ITEM,this.chooseItem,this),this.icon.setSprite(o),this.progressSpr.fillRange=t.expValue,this.id=t.id,this.cost.node.active=e,this.lvLabel.node.active=!e,this.cost.string=""+t.lockMoney,this.lvLabel.string="\u7b49\u7ea7 "+t.level},e.prototype.chooseItem=function(t){this.chooseNode.active=t==this.id},e.prototype.onBtnChoose=function(){c.default.instance.emit(r.ENUM_GAME_EVENT.READYUI_CHOOSE_ITEM,this.id)},e.prototype.onDestroy=function(){c.default.instance.off(r.ENUM_GAME_EVENT.READYUI_CHOOSE_ITEM,this.chooseItem,this)},a([u(cc.Sprite)],e.prototype,"icon",void 0),a([u(cc.Sprite)],e.prototype,"progressSpr",void 0),a([u(cc.Node)],e.prototype,"chooseNode",void 0),a([u(cc.Node)],e.prototype,"lock",void 0),a([u(cc.Label)],e.prototype,"cost",void 0),a([u(cc.Label)],e.prototype,"lvLabel",void 0),a([l],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../Data/Enum":"Enum","../../../Manager/EventManager":"EventManager"}],ReadyToolItem:[function(t,e,o){"use strict";cc._RF.push(e,"c5c93fVYz9MDLt1Eiyp4unw","ReadyToolItem");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,o,r):i(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../../Data/Enum"),c=t("../../../Manager/EventManager"),s=cc._decorator,l=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.chooseNode=null,e.nameLabel=null,e.diamondCost=null,e.id=0,e}return i(e,t),e.prototype.init=function(t){this.id=t.id,this.nameLabel.string=t.name,this.diamondCost.string=t.diamondCost+"";var e=r.TOOL_TYPE_TEXTUREURL[t.id];this.icon.setSprite(e),c.default.instance.on(r.ENUM_GAME_EVENT.READYUI_CHOOSE_TOOLITEM,this.chooseItem,this)},e.prototype.chooseItem=function(t){this.chooseNode.active=t==this.id},e.prototype.onBtnChoose=function(){c.default.instance.emit(r.ENUM_GAME_EVENT.READYUI_CHOOSE_TOOLITEM,this.id)},e.prototype.onDestroy=function(){c.default.instance.off(r.ENUM_GAME_EVENT.READYUI_CHOOSE_TOOLITEM,this.chooseItem,this)},a([u(cc.Sprite)],e.prototype,"icon",void 0),a([u(cc.Node)],e.prototype,"chooseNode",void 0),a([u(cc.Label)],e.prototype,"nameLabel",void 0),a([u(cc.Label)],e.prototype,"diamondCost",void 0),a([l],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../../Data/Enum":"Enum","../../../Manager/EventManager":"EventManager"}],ReadyUI:[function(t,e,o){"use strict";cc._RF.push(e,"28d476iNIRGR6CDkbq17X0A","ReadyUI");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,o,r):i(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../Data/Enum"),c=t("../../Data/GameData"),s=t("../../Manager/EventManager"),l=t("../DataManager"),u=t("../GameUtils"),p=t("./Item/ReadyAnimalItem"),h=t("./Item/ReadyToolItem"),d=cc._decorator,f=d.ccclass,y=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isPlayAni=!1,e.centerUI=null,e.uiRoot=null,e.diamond=null,e.animalPosRoot=null,e.animalRoot=null,e.animalPrefab=null,e.lastPageBtn=null,e.nextPageBtn=null,e.useAniIcon=null,e.chooseAniIcon=null,e.animName=null,e.animDesc=null,e.animScore=null,e.animLevel=null,e.animExpProgress=null,e.buyAnimRoot=null,e.animBuyCost=null,e.unLockInfoRoot=null,e.pagePointArr=[],e.toolsPosRoot=null,e.toolsRoot=null,e.toolPrefab=null,e.buyToolBtn=null,e.chooseToolIcon=null,e.toolDesc=null,e.animUIRoot=null,e.toolsUIRoot=null,e.btnStart=null,e.btnReady=null,e.showType=1,e.animalData=[],e.currentAnimalPage=0,e.chooseAnimID=-1,e}return i(e,t),e.prototype.onAwake=function(){this.isPlayAni=!1,this.startAnim(),this.initAnimalUI()},e.prototype.initAnimalUI=function(){var t=this;this.showType=1,this.animUIRoot.active=!0,this.toolsUIRoot.active=!1,this.btnReady.active=!0,this.btnStart.active=!1,s.default.instance.on(r.ENUM_GAME_EVENT.READYUI_CHOOSE_ITEM,this.initUseAnim,this),this.diamond.string=u.default.formatNumber(l.default.instance.diamond),this.animalData=[],this.currentAnimalPage=0,this.chooseAnimID=l.default.instance.useAnimId,l.default.instance.animalData.forEach(function(e,o){var n=Math.floor(o/t.animalPosRoot.childrenCount);t.animalData[n]?t.animalData[n].push(e):(t.animalData[n]=[],t.animalData[n].push(e)),n=null}),this.showPage(this.currentAnimalPage)},e.prototype.showPage=function(t){this.animalRoot.removeAllChildren(),this.pagePointArr.forEach(function(e,o){e.active=o==t}),this.nextPageBtn.active=t<this.animalData.length-1,this.lastPageBtn.active=t>0;for(var e=0;e<this.animalData[t].length;e++)if(cc.isValid(this.animalPosRoot.children[e])){var o=this.animalData[t][e],n=cc.instantiate(this.animalPrefab);n.parent=this.animalRoot,n.position=this.animalPosRoot.children[e].position,n.getComponent(p.default).init(o)}s.default.instance.emit(r.ENUM_GAME_EVENT.READYUI_CHOOSE_ITEM,this.chooseAnimID)},e.prototype.initToolUI=function(){this.showType=2,this.animUIRoot.active=!1,this.toolsUIRoot.active=!0,this.btnReady.active=!1,this.btnStart.active=!0,s.default.instance.on(r.ENUM_GAME_EVENT.READYUI_CHOOSE_TOOLITEM,this.initUseTool,this),this.toolsRoot.removeAllChildren();for(var t=0;t<l.default.instance.toolData.length;t++){var e=l.default.instance.toolData[t],o=cc.instantiate(this.toolPrefab);o.parent=this.toolsRoot,o.position=this.toolsPosRoot.children[t].position,o.getComponent(h.default).init(e)}s.default.instance.emit(r.ENUM_GAME_EVENT.READYUI_CHOOSE_TOOLITEM,-1)},e.prototype.initUseAnim=function(t){var e=l.default.instance.getAnimalDataById(t);if(e){this.chooseAnimID=t;var o=r.ANIMAL_TYPE_TEXTUREURL[t];this.chooseAniIcon.setSprite(o),this.animName.string=e.name,this.animDesc.string=e.desc;var n=!e.isLock||0==e.lockMoney;this.buyAnimRoot.active=!n,this.unLockInfoRoot.active=n,n?(this.animExpProgress.fillRange=e.expValue,this.animLevel.string="\u7b49\u7ea7 "+e.level+"/"+c.AnimalMaxLevel,this.animScore.string=e.score+"",l.default.instance.useAnimId=t,this.useAniIcon.setSprite(o)):this.animBuyCost.string=""+e.lockMoney}},e.prototype.initUseTool=function(t){var e=l.default.instance.getToolDataById(t);if(!e)return this.buyToolBtn.active=!1,void(this.toolDesc.string=c.ToolTip);this.buyToolBtn.active=!0;var o=r.TOOL_TYPE_TEXTUREURL[t];this.chooseToolIcon.setSprite(o),this.toolDesc.string=e.desc},e.prototype.onBtnNextPage=function(){this.isPlayAni||this.currentAnimalPage>=this.animalData.length-1||(this.currentAnimalPage++,this.showPage(this.currentAnimalPage))},e.prototype.onBtnLastNextPage=function(){this.isPlayAni||this.currentAnimalPage<=0||(this.currentAnimalPage--,this.showPage(this.currentAnimalPage))},e.prototype.onBtnStartGame=function(){this.isPlayAni||this.quitAnim()},e.prototype.onBtnSwitchToAnimal=function(){var t=this;this.isPlayAni||1!=this.showType&&(this.btnReady.active=!0,this.btnStart.active=!1,this.switchAni(function(){t.initAnimalUI()}))},e.prototype.onBtnSwitchToTools=function(){var t=this;this.isPlayAni||2!=this.showType&&(this.showType=2,this.btnReady.active=!1,this.btnStart.active=!0,this.switchAni(function(){t.initToolUI()}))},e.prototype.startAnim=function(){var t=this;this.uiRoot.stopAllActions(),this.isPlayAni=!0;var e=.5*cc.winSize.height+700;this.uiRoot.setPosition(cc.v3(0,e)),cc.tween(this.uiRoot).to(.3,{y:0},{easing:"quadIn"}).call(function(){t.isPlayAni=!1}).start()},e.prototype.switchAni=function(t,e){var o=this;void 0===e&&(e=!0),this.centerUI.stopAllActions(),this.isPlayAni=!0;var n=-cc.winSize.width-300,i=cc.winSize.width+300;cc.tween(this.centerUI).to(.3,{x:e?n:i}).to(0,{x:e?i:n}).call(function(){t&&t()}).to(.3,{x:0}).call(function(){o.isPlayAni=!1}).start()},e.prototype.quitAnim=function(){var t=this;this.node.stopAllActions(),this.isPlayAni=!0;var e=.5*cc.winSize.height+700;cc.tween(this.node).to(.5,{y:e},{easing:"quadOut"}).call(function(){cc.resources.release(r.GAME_Prefab.readyUI.url),t.node.destroy(),s.default.instance.emit(r.ENUM_GAME_EVENT.GAME_START)}).start()},e.prototype.onDestroy=function(){s.default.instance.off(r.ENUM_GAME_EVENT.READYUI_CHOOSE_ITEM,this.initUseAnim,this),s.default.instance.off(r.ENUM_GAME_EVENT.READYUI_CHOOSE_TOOLITEM,this.initUseTool,this)},a([y(cc.Node)],e.prototype,"centerUI",void 0),a([y(cc.Node)],e.prototype,"uiRoot",void 0),a([y(cc.Label)],e.prototype,"diamond",void 0),a([y(cc.Node)],e.prototype,"animalPosRoot",void 0),a([y(cc.Node)],e.prototype,"animalRoot",void 0),a([y(cc.Prefab)],e.prototype,"animalPrefab",void 0),a([y(cc.Node)],e.prototype,"lastPageBtn",void 0),a([y(cc.Node)],e.prototype,"nextPageBtn",void 0),a([y(cc.Sprite)],e.prototype,"useAniIcon",void 0),a([y(cc.Sprite)],e.prototype,"chooseAniIcon",void 0),a([y(cc.Label)],e.prototype,"animName",void 0),a([y(cc.Label)],e.prototype,"animDesc",void 0),a([y(cc.Label)],e.prototype,"animScore",void 0),a([y(cc.Label)],e.prototype,"animLevel",void 0),a([y(cc.Sprite)],e.prototype,"animExpProgress",void 0),a([y(cc.Node)],e.prototype,"buyAnimRoot",void 0),a([y(cc.Label)],e.prototype,"animBuyCost",void 0),a([y(cc.Node)],e.prototype,"unLockInfoRoot",void 0),a([y(cc.Node)],e.prototype,"pagePointArr",void 0),a([y(cc.Node)],e.prototype,"toolsPosRoot",void 0),a([y(cc.Node)],e.prototype,"toolsRoot",void 0),a([y(cc.Prefab)],e.prototype,"toolPrefab",void 0),a([y(cc.Node)],e.prototype,"buyToolBtn",void 0),a([y(cc.Sprite)],e.prototype,"chooseToolIcon",void 0),a([y(cc.Label)],e.prototype,"toolDesc",void 0),a([y(cc.Node)],e.prototype,"animUIRoot",void 0),a([y(cc.Node)],e.prototype,"toolsUIRoot",void 0),a([y(cc.Node)],e.prototype,"btnStart",void 0),a([y(cc.Node)],e.prototype,"btnReady",void 0),a([f],e)}(cc.Component);o.default=m,cc._RF.pop()},{"../../Data/Enum":"Enum","../../Data/GameData":"GameData","../../Manager/EventManager":"EventManager","../DataManager":"DataManager","../GameUtils":"GameUtils","./Item/ReadyAnimalItem":"ReadyAnimalItem","./Item/ReadyToolItem":"ReadyToolItem"}],ResManager:[function(t,e,o){"use strict";cc._RF.push(e,"a7c84pJVFdH27jEvFPPottt","ResManager");var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(i,a){function r(t){try{s(n.next(t))}catch(e){a(e)}}function c(t){try{s(n.throw(t))}catch(e){a(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(r,c)}s((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var o,n,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(t){return function(e){return s([t,e])}}function s(a){if(o)throw new TypeError("Generator is already executing.");for(;r;)try{if(o=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,n=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(6===a[0]&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],n=0}finally{o=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var a=function(){function t(){}return t.getInstance=function(){return null===this._instance&&(this._instance=new this),this._instance},Object.defineProperty(t,"instance",{get:function(){return this.getInstance()},enumerable:!1,configurable:!0}),t.prototype.loadRes=function(t){return n(this,void 0,Promise,function(){return i(this,function(){return[2,new Promise(function(e,o){var n=cc.resources.get(t);if(n)return e(n);cc.resources.load(t,function(t,n){t?o("loadRes fail"+t):e(n)})})]})})},t._instance=null,t}();o.default=a,cc._RF.pop()},{}],StartUI:[function(t,e,o){"use strict";cc._RF.push(e,"f14a3L4JpRBsbqJqH+rfB9P","StartUI");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var i,a=arguments.length,r=a<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,o,r):i(e,o))||r);return a>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var r=t("../../Data/Enum"),c=cc._decorator,s=c.ccclass,l=c.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.topUI=null,e.grassLeft=null,e.grassRight=null,e.startBtn=null,e.bottomUI=null,e.quitCB=null,e}return i(e,t),e.prototype.onLoad=function(){},e.prototype.onAwake=function(){this.dropAndBounce(this.topUI),this.grassAni(),this.startBtnAni()},e.prototype.onQuit=function(){var t=this;this.topQuitAni(function(){cc.resources.release(r.GAME_Prefab.startUI.url),t.quitCB&&t.quitCB(),t.node.destroy()}),this.bottomQuitAni()},e.prototype.topQuitAni=function(t){this.topUI.stopAllActions();var e=.5*cc.winSize.height;cc.tween(this.topUI).to(.5,{y:e},{easing:"quadOut"}).call(function(){t&&t()}).start()},e.prototype.bottomQuitAni=function(){this.bottomUI.stopAllActions();var t=-.5*cc.winSize.height-200;cc.tween(this.bottomUI).to(.5,{y:t},{easing:"quadOut"}).start()},e.prototype.dropAndBounce=function(t){var e=.5*cc.winSize.height+200;t.setPosition(cc.v3(0,e)),t.stopAllActions(),cc.tween(t).to(.3,{y:200},{easing:"quadIn"}).to(.2,{y:250},{easing:"quadOut"}).to(.15,{y:200},{easing:"quadIn"}).to(.1,{y:200+50/3},{easing:"quadOut"}).to(.08,{y:200},{easing:"quadIn"}).start()},e.prototype.grassAni=function(){this.grassLeft.stopAllActions(),this.grassRight.stopAllActions(),cc.tween(this.grassLeft).repeatForever(cc.tween().to(1,{angle:2}).to(2,{angle:-2}).to(1,{angle:0})).start(),cc.tween(this.grassRight).repeatForever(cc.tween().to(1,{angle:2}).to(2,{angle:-2}).to(1,{angle:0})).start()},e.prototype.startBtnAni=function(){this.startBtn.active=!0,this.startBtn.y=-450,this.startBtn.opacity=255,this.startBtn.stopAllActions(),cc.tween(this.startBtn).repeatForever(cc.tween(this.startBtn).to(2,{opacity:0},{easing:"quadOut"}).to(2,{opacity:255},{easing:"quadIn"})).start()},e.prototype.onBtnStart=function(){this.onQuit()},a([l(cc.Node)],e.prototype,"topUI",void 0),a([l(cc.Node)],e.prototype,"grassLeft",void 0),a([l(cc.Node)],e.prototype,"grassRight",void 0),a([l(cc.Node)],e.prototype,"startBtn",void 0),a([l(cc.Node)],e.prototype,"bottomUI",void 0),a([s],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../Data/Enum":"Enum"}]},{},["Enum","GameData","AnimalChoose","AnimalCube","AnimalManager","DataManager","Game","GameUtils","Main","ReadyAnimalItem","ReadyToolItem","LoadSceneUI","MainBgUI","ReadyUI","StartUI","EventManager","PoolManager","ResManager"]);