window.__require=function t(e,n,o){function i(r,c){if(!n[r]){if(!e[r]){var s=r.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+r+"'")}r=s}var u=n[r]={exports:{}};e[r][0].call(u.exports,function(t){return i(e[r][1][t]||t)},u,u.exports,t,e,n,o)}return n[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<o.length;r++)i(o[r]);return i}({AnimalChoose:[function(t,e,n){"use strict";cc._RF.push(e,"98cacqDxx1Cn5UNUVkSVhq6","AnimalChoose");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.target=null,e}return i(e,t),e.prototype.setTarget=function(t){this.target=t},e.prototype.update=function(){if(cc.isValid(this.target)&&cc.isValid(this.target.parent)){var t=this.target.parent.convertToWorldSpaceAR(this.target.position);t=this.node.parent.convertToNodeSpaceAR(t),this.node.position=t}},a([c],e)}(cc.Component));n.default=s,cc._RF.pop()},{}],AnimalCube:[function(t,e,n){"use strict";cc._RF.push(e,"8dee9WqOmxE8pESL+BCs6FX","AnimalCube");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},r=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,a){function r(t){try{s(o.next(t))}catch(e){a(e)}}function c(t){try{s(o.throw(t))}catch(e){a(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(r,c)}s((o=o.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var n,o,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(t){return function(e){return s([t,e])}}function s(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(6===a[0]&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../Data/Enum"),l=t("../../Manager/AudioManager"),u=t("../../Manager/EventManager"),p=t("../../Manager/PoolManager"),d=cc._decorator,h=d.ccclass,f=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animalIcon=null,e.boomAni=null,e.rigiBody=null,e.collider=null,e.animType=null,e.isChoose=!1,e.showSpriteFrame=null,e.lightSpriteFrame=null,e.outLineSpriteFrame=null,e.tipSpriteFrame=null,e}return i(e,t),e.prototype.onLoad=function(){this.rigiBody=this.node.getComponent(cc.RigidBody)},e.prototype.init=function(t,e){var n=this;this.node.scale=t,this.animType=e,this.boomAni.node.active=!1,cc.resources.load(s.ANIMAL_TYPE_TEXTUREURL[e],cc.SpriteFrame,function(t,e){t||(n.animalIcon.spriteFrame=e,n.showSpriteFrame=e)}),cc.resources.load(s.ANIMAL_TYPE_TEXTUREURL[e]+"_outline",cc.SpriteFrame,function(t,e){t||(n.outLineSpriteFrame=e)}),cc.resources.load(s.ANIMAL_TYPE_TEXTUREURL[e]+"_light",cc.SpriteFrame,function(t,e){t||(n.lightSpriteFrame=e)}),cc.resources.load(s.ANIMAL_TYPE_TEXTUREURL[e]+"_tip",cc.SpriteFrame,function(t,e){t||(n.tipSpriteFrame=e)}),u.default.instance.on(s.ENUM_GAME_EVENT.GAME_BTN_JUMP_ITEM,this.jump,this),this.setChoose(!1)},e.prototype.showLight=function(){this.isChoose||(this.switchMaterial(!1),this.animalIcon.spriteFrame=this.lightSpriteFrame)},e.prototype.showTip=function(){this.isChoose||(this.animalIcon.spriteFrame=this.tipSpriteFrame,this.animalIcon.node.stopAllActions(),this.animalIcon.node.opacity=255,cc.tween(this.animalIcon.node).repeatForever(cc.tween(this.animalIcon.node).to(1,{opacity:180}).to(1,{opacity:255}).start()).start())},e.prototype.clearLight=function(){this.switchMaterial(!1),this.animalIcon.spriteFrame=this.showSpriteFrame},e.prototype.clearTip=function(){this.switchMaterial(!1),this.animalIcon.spriteFrame=this.showSpriteFrame,this.animalIcon.node.stopAllActions(),this.animalIcon.node.opacity=255},e.prototype.setChoose=function(t,e){return void 0===e&&(e=0),r(this,void 0,void 0,function(){return c(this,function(){return this.isChoose=t,[2]})})},e.prototype.chooseAni=function(){this.switchMaterial(),this.animalIcon.node.stopAllActions(),this.animalIcon.node.scale=1,cc.tween(this.animalIcon.node).to(.12,{scale:1.2},{easing:"cubicOut"}).to(.1,{scale:.9},{easing:"cubicInOut"}).to(.1,{scale:1},{easing:"bounceOut"}).start()},e.prototype.switchMaterial=function(t){void 0===t&&(t=!0),t?(this.animalIcon.spriteFrame=this.outLineSpriteFrame,this.animalIcon.node.group="gameUI"):(this.animalIcon.spriteFrame=this.showSpriteFrame,this.animalIcon.node.group="animal")},e.prototype.getChooseType=function(){return this.isChoose},e.prototype.jump=function(){if(cc.isValid(this.rigiBody)){var t=Math.floor(1e6*(2*Math.random()-1));this.rigiBody.applyForce(cc.v2(t,1e6),this.rigiBody.getWorldCenter(),!0)}},e.prototype.remove=function(t,e){var n=this;this.scheduleOnce(function(){n.boomAni.node.active=!0,n.boomAni.play("animBoom"),l.default.instance.playSound(s.ENUM_AUDIO_CLIP.COMBO),n.animalIcon.node.stopAllActions(),n.animalIcon.node.group="gameUI",n.animalIcon.node.scale=n.animalIcon.node.scale*(.8/n.node.scale),e=n.animalIcon.node.parent.convertToNodeSpaceAR(e),cc.tween(n.animalIcon.node).to(.2,{position:e}).call(function(){n.animalIcon.spriteFrame=null,n.animalIcon.node.group="animal",n.animalIcon.node.setPosition(cc.Vec3.ZERO),n.animalIcon.node.scale=1,p.default.instance.putNode(n.node,s.GAME_POOL.ANIMAL_POOL),n.animType=null,n.isChoose=!1,u.default.instance.off(s.ENUM_GAME_EVENT.GAME_BTN_JUMP_ITEM,n.jump,n)}).start()},.1*t)},a([f(cc.Sprite)],e.prototype,"animalIcon",void 0),a([f(cc.Animation)],e.prototype,"boomAni",void 0),a([h],e)}(cc.Component);n.default=m,cc._RF.pop()},{"../../Data/Enum":"Enum","../../Manager/AudioManager":"AudioManager","../../Manager/EventManager":"EventManager","../../Manager/PoolManager":"PoolManager"}],AnimalLevelItem:[function(t,e,n){"use strict";cc._RF.push(e,"c590ei8I8hLyKekQ9nB5s8W","AnimalLevelItem");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../../Data/Enum"),c=t("../../../Data/GameData"),s=t("../../DataManager"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentLevel=null,e.addScoreLevel=null,e.levelMaxValue=null,e.lockTip=null,e.icon=null,e.levelProgress=null,e}return i(e,t),e.prototype.initUI=function(t,e){var n=s.default.instance.getAnimalDataById(t);if(this.icon.setSprite(r.ANIMAL_TYPE_TEXTUREURL[t]),n.isLock&&0!=n.lockMoney)this.currentLevel.node.parent.active=!1,this.lockTip.active=!0;else{this.currentLevel.node.parent.active=!0,this.lockTip.active=!1,this.addScoreLevel.string="+"+e;for(var o=n.expValue*(c.FactorLevelTsum[n.level-1]-(n.level>1?c.FactorLevelTsum[n.level-2]:0))+(n.level>1?c.FactorLevelTsum[n.level-2]:0)+e,i=1,a=0;a<c.FactorLevelTsum.length;a++)c.FactorLevelTsum[a]<=o&&(i=a+1);var l=(o-((i=i>6?6:i)>1?c.FactorLevelTsum[i-2]:0))/(c.FactorLevelTsum[n.level-1]-(i>1?c.FactorLevelTsum[i-2]:0));this.levelProgress.fillRange=l,this.levelMaxValue.string="\u9700\u8981\u6d88\u9664\u6570\u91cf "+c.FactorLevelTsum[i-1]+" \u5347\u7ea7",this.currentLevel.string="lv."+i,n.expValue=l,n.level=i}},a([p(cc.Label)],e.prototype,"currentLevel",void 0),a([p(cc.Label)],e.prototype,"addScoreLevel",void 0),a([p(cc.Label)],e.prototype,"levelMaxValue",void 0),a([p(cc.Node)],e.prototype,"lockTip",void 0),a([p(cc.Sprite)],e.prototype,"icon",void 0),a([p(cc.Sprite)],e.prototype,"levelProgress",void 0),a([u],e)}(cc.Component);n.default=d,cc._RF.pop()},{"../../../Data/Enum":"Enum","../../../Data/GameData":"GameData","../../DataManager":"DataManager"}],AnimalManager:[function(t,e,n){"use strict";cc._RF.push(e,"c1901OG/hJAdJmWEqegNHiq","AnimalManager"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.getInstance=function(){return null===this._instance&&(this._instance=new this),this._instance},Object.defineProperty(t,"instance",{get:function(){return this.getInstance()},enumerable:!1,configurable:!0}),t._instance=null,t}();n.default=o,cc._RF.pop()},{}],AudioManager:[function(t,e,n){"use strict";cc._RF.push(e,"499a20sm3RNqab2fGw/3Y8i","AudioManager");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,a){function r(t){try{s(o.next(t))}catch(e){a(e)}}function c(t){try{s(o.throw(t))}catch(e){a(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(r,c)}s((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(t){return function(e){return s([t,e])}}function s(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(6===a[0]&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../Data/Enum"),r=t("../Game/DataManager"),c=t("./ResManager"),s=function(){function t(){this.audioSource=null}return t.getInstance=function(){return null===this._instance&&(this._instance=new this,this._instance.init()),this._instance},Object.defineProperty(t,"instance",{get:function(){return this.getInstance()},enumerable:!1,configurable:!0}),t.prototype.init=function(){this.audioSource=new cc.AudioSource,this.audioSource.loop=!0},t.prototype.playMusic=function(){return o(this,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:if(this.stopMusic(),0==r.default.instance.musicValue)return[2];switch(t=null,r.default.instance.gameState){case 1:return[3,1];case 2:return[3,3];case 3:return[3,5]}return[3,7];case 1:return[4,c.default.instance.loadRes(a.ENUM_AUDIO_CLIP.INTRO_BGM)];case 2:return t=e.sent(),[3,8];case 3:return[4,c.default.instance.loadRes(a.ENUM_AUDIO_CLIP.GMAE_BGM)];case 4:return t=e.sent(),[3,8];case 5:return[4,c.default.instance.loadRes(a.ENUM_AUDIO_CLIP.CRAZY_BGM)];case 6:return t=e.sent(),[3,8];case 7:return[3,8];case 8:return cc.isValid(t)&&(this.audioSource.clip=t,this.audioSource.play()),[2]}})})},t.prototype.stopMusic=function(){this.audioSource.clip&&this.audioSource.stop()},t.prototype.playBtn=function(){this.playSound(a.ENUM_AUDIO_CLIP.BUTTON)},t.prototype.playSound=function(t,e){return void 0===e&&(e=!1),o(this,void 0,void 0,function(){var n;return i(this,function(o){switch(o.label){case 0:return 0==r.default.instance.effectValue?[2]:[4,c.default.instance.loadRes(t)];case 1:return n=o.sent(),[2,cc.audioEngine.playEffect(n,e)]}})})},t.prototype.stopSound=function(){cc.audioEngine.stopAllEffects()},t._instance=null,t}();n.default=s,cc._RF.pop()},{"../Data/Enum":"Enum","../Game/DataManager":"DataManager","./ResManager":"ResManager"}],DataManager:[function(t,e,n){"use strict";cc._RF.push(e,"fa4a9Ec1utAiJ+aaPeIEK5b","DataManager");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,a){function r(t){try{s(o.next(t))}catch(e){a(e)}}function c(t){try{s(o.throw(t))}catch(e){a(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(r,c)}s((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(t){return function(e){return s([t,e])}}function s(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(6===a[0]&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.ToolData=n.AnimalData=void 0;var a=t("../Data/Enum"),r=t("../Data/GameData"),c=t("../Manager/EventManager"),s=t("../Manager/ResManager"),l="ANIMAL_LEVELDATA_GAME_ANIMAL_",u="TOOL_COUNTDATA_GAME_ANIMAL",p=function(){function t(t){r.useFirstData;var e=cc.sys.localStorage.getItem(l+t);e&&""!=e?(e=JSON.parse(e),this._level=e.level,this._isLock=e.isLock,this._expValue=e.expValue,this._score=e.score):(this._level=1,this._isLock=!0,this._expValue=0,this._score=0)}return Object.defineProperty(t.prototype,"level",{get:function(){return this._level},set:function(t){this._level=t,this.save()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLock",{get:function(){return this._isLock},set:function(t){this._isLock=t,this.save()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"expValue",{get:function(){return this._expValue},set:function(t){this._expValue=t,this.save()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"score",{get:function(){return this._score},set:function(t){this._score=t,this.save()},enumerable:!1,configurable:!0}),t.prototype.save=function(){cc.sys.localStorage.setItem(l+this.id,JSON.stringify({level:this.level,isLock:this.isLock,expValue:this.expValue,score:this.score}))},t}();n.AnimalData=p;var d=function(){function t(t){r.useFirstData;var e=cc.sys.localStorage.getItem(u+t);e&&""!=e?(e=JSON.parse(e),this.countNumber=e.countNumber):this.countNumber=0}return Object.defineProperty(t.prototype,"countNumber",{get:function(){return this._countNumber},set:function(t){this._countNumber=t,this.save()},enumerable:!1,configurable:!0}),t.prototype.save=function(){cc.sys.localStorage.setItem(u+this.id,JSON.stringify({countNumber:this.countNumber}))},t}();n.ToolData=d;var h=function(){function t(){this._diamond=0,this._maxScore=0,this._useAnimId=0,this.gameState=0,this.currentScore=0,this.currentDeleteAnimal=0,this._effectValue=0,this._musicValue=0,this.animalData=[],this.toolData=[],this.currentUseToolID=-1}return t.getInstance=function(){return null===this._instance&&(this._instance=new this),this._instance},Object.defineProperty(t,"instance",{get:function(){return this.getInstance()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"diamond",{get:function(){return this._diamond},set:function(t){this._diamond=t,this.save()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxScore",{get:function(){return this._maxScore},set:function(t){this._maxScore=t,this.save()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"useAnimId",{get:function(){return this._useAnimId},set:function(t){this._useAnimId=t,this.save()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effectValue",{get:function(){return this._effectValue},set:function(t){this._effectValue=t,this.saveAudioData()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"musicValue",{get:function(){return this._musicValue},set:function(t){this._musicValue=t,this.saveAudioData()},enumerable:!1,configurable:!0}),t.prototype.save=function(){cc.sys.localStorage.setItem("STORAGE_KEY_GAME_ANIMAL",JSON.stringify({diamond:this.diamond,maxScore:this.maxScore,useAnimId:this.useAnimId}))},t.prototype.saveAudioData=function(){cc.sys.localStorage.setItem("AUDIODATA_GAME_ANIMAL",JSON.stringify({effectValue:this.effectValue,musicValue:this.musicValue}))},t.prototype.init=function(t){return o(this,void 0,void 0,function(){var e,n,o;return i(this,function(i){switch(i.label){case 0:return r.useFirstData,e=this,[4,this.loadLocalAnimalData()];case 1:if(e.animalData=i.sent(),n=cc.sys.localStorage.getItem("STORAGE_KEY_GAME_ANIMAL"),o=cc.sys.localStorage.getItem("AUDIODATA_GAME_ANIMAL"),n&&""!=n)try{n=JSON.parse(n),this._diamond=n.diamond,this._maxScore=n.maxScore,this._useAnimId=n.useAnimId}catch(a){console.error("cc.sys.localStorage.getItem(STORAGE_KEY) error",a)}else this._diamond=r.InitDiamondCount,this._maxScore=0,this.useAnimId=1;if(o&&""!=o)try{o=JSON.parse(o),this._effectValue=o.effectValue,this._musicValue=o.musicValue}catch(a){console.error("cc.sys.localStorage.getItem(STORAGE_KEY) error",a)}else this._effectValue=1,this._musicValue=1;return this.loadLocalToolData(),this.currentUseToolID=-1,t&&t(),[2]}})})},t.prototype.getAnimalDataById=function(t){for(var e=0;e<this.animalData.length;e++)if(t==this.animalData[e].id)return this.animalData[e]},t.prototype.getToolDataById=function(t){for(var e=0;e<this.toolData.length;e++)if(t==this.toolData[e].id)return this.toolData[e]},t.prototype.loadLocalAnimalData=function(){return o(this,void 0,Promise,function(){var t,e,n,o,r;return i(this,function(i){switch(i.label){case 0:return[4,s.default.instance.loadRes(a.JsonUrl.animalJson)];case 1:for(t=i.sent(),e=[],n=0;n<t.json.length;n++)o=t.json[n],(r=new p(o.id)).id=o.id,r.desc=o.desc,r.lockMoney=o.lockMoney,r.name=o.name,r.skillNeedCube=o.skillNeedCube,e.push(r);return[2,e]}})})},t.prototype.loadLocalToolData=function(){this.toolData=[];for(var t=0;t<r.ToolDataLocal.length;t++){var e=r.ToolDataLocal[t],n=new d(e[0]);n.id=e[0],n.name=e[1],n.desc=e[2],n.diamondCost=e[3],this.toolData.push(n)}},t.prototype.buyAnimal=function(t){var e=this.getAnimalDataById(t);return!(e.lockMoney>this.diamond||(this.diamond-=e.lockMoney,e.isLock=!1,c.default.instance.emit(a.ENUM_GAME_EVENT.UPDATE_DIAMOND_COUNT),0))},t.prototype.buyTool=function(t){var e=this.getToolDataById(t);return!(e.diamondCost>this.diamond||(this.diamond-=e.diamondCost,e.countNumber++,c.default.instance.emit(a.ENUM_GAME_EVENT.UPDATE_DIAMOND_COUNT),0))},t.prototype.addDiamond=function(t){this.diamond+=t,c.default.instance.emit(a.ENUM_GAME_EVENT.UPDATE_DIAMOND_COUNT)},t._instance=null,t}();n.default=h,cc._RF.pop()},{"../Data/Enum":"Enum","../Data/GameData":"GameData","../Manager/EventManager":"EventManager","../Manager/ResManager":"ResManager"}],Enum:[function(t,e,n){"use strict";var o,i,a,r;cc._RF.push(e,"4a8b3BwkFpMBroR58wZ+RBe","Enum"),Object.defineProperty(n,"__esModule",{value:!0}),n.BaseScore=n.ENUM_AUDIO_CLIP=n.JsonUrl=n.GAME_Prefab=n.TOOL_TYPE_TEXTUREURL=n.TOOL_TYPE=n.ANIMAL_TYPE_TEXTUREURL=n.ANIMAL_TYPE=n.GAME_POOL=n.ENUM_GAME_EVENT=void 0,function(t){t.GAME_BTN_JUMP_ITEM="GAME_BTN_JUMP_ITEM",t.READYUI_CHOOSE_ITEM="READYUI_CHOOSE_ITEM",t.READYUI_CHOOSE_TOOLITEM="READYUI_CHOOSE_TOOLITEM",t.READYUI_REFRESH_ITEM="READYUI_REFRESH_ITEM",t.READYUI_REFRESH_TOOLITEM="READYUI_REFRESH_TOOLITEM",t.GAME_START="GAME_START",t.UPDATE_DIAMOND_COUNT="UPDATE_DIAMOND_COUNT",t.GAME_PLAYSTART="GAME_PLAYSTART",t.QUIT_GAME="QUIT_GAME",t.QUIT_SETTING="QUIT_SETTING",t.SHOW_GAMESCORE="SHOW_GAMESCORE"}(n.ENUM_GAME_EVENT||(n.ENUM_GAME_EVENT={})),function(t){t.ANIMAL_POOL="ANIMAL_POOL",t.ANIMAL_CHOOSE="ANIMAL_CHOOSE",t.ANIMAL_LINE="ANIMAL_LINE",t.UI_SCORE_FLY="UI_SCORE_FLY"}(n.GAME_POOL||(n.GAME_POOL={})),function(t){t[t.Bear=1]="Bear",t[t.Kitty=2]="Kitty",t[t.Frog=3]="Frog",t[t.Pengu=4]="Pengu",t[t.Fox=5]="Fox",t[t.Owl=6]="Owl",t[t.Rabbit=7]="Rabbit",t[t.Hippo=8]="Hippo",t[t.Piggy=9]="Piggy",t[t.Koala=10]="Koala",t[t.Duck=11]="Duck",t[t.Snake=12]="Snake"}(a=n.ANIMAL_TYPE||(n.ANIMAL_TYPE={})),n.ANIMAL_TYPE_TEXTUREURL=((o={})[a.Bear]="pic/animal/1",o[a.Kitty]="pic/animal/2",o[a.Frog]="pic/animal/3",o[a.Pengu]="pic/animal/4",o[a.Fox]="pic/animal/5",o[a.Owl]="pic/animal/6",o[a.Rabbit]="pic/animal/7",o[a.Hippo]="pic/animal/8",o[a.Piggy]="pic/animal/9",o[a.Koala]="pic/animal/10",o[a.Duck]="pic/animal/11",o[a.Snake]="pic/animal/12",o),function(t){t[t.SCORE=1]="SCORE",t[t.GEM=2]="GEM",t[t.BUBBLE=3]="BUBBLE",t[t.TIME=4]="TIME",t[t.FIVETOFOUR=5]="FIVETOFOUR"}(r=n.TOOL_TYPE||(n.TOOL_TYPE={})),n.TOOL_TYPE_TEXTUREURL=((i={})[r.SCORE]="pic/tools/1",i[r.GEM]="pic/tools/2",i[r.BUBBLE]="pic/tools/3",i[r.TIME]="pic/tools/4",i[r.FIVETOFOUR]="pic/tools/5",i),n.GAME_Prefab={mainBg:{zIndex:1,url:"prefab/UI/mainBgUI"},startUI:{zIndex:2,url:"prefab/UI/startUI"},readyUI:{zIndex:2,url:"prefab/UI/readyUI"},settingUI:{zIndex:2,url:"prefab/UI/settingUI"},loadSceneUI:{zIndex:3,url:"prefab/UI/loadSceneUI"},gameUI:{zIndex:1,url:"prefab/game/game"},gameSettingUI:{zIndex:2,url:"prefab/UI/gameSettingUI"},levelshowUI:{zIndex:3,url:"prefab/UI/levelShowUI"},scoreUI:{zIndex:3,url:"prefab/UI/scoreUI"},loadUI:{zIndex:4,url:"prefab/UI/loadUI"},animLine:"prefab/AnimalLine",animChoose:"prefab/AnimalChoose"},n.JsonUrl={animalJson:"jsons/animal"},function(t){t.INTRO_BGM="audio/bgm/introMusic",t.GMAE_BGM="audio/bgm/inGameMusic",t.CRAZY_BGM="audio/bgm/crazyGameMusic",t.BUTTON="audio/effect/button",t.PLAY="audio/effect/Play",t.NOMONEY="audio/effect/NoMoney",t.GETNEW="audio/effect/GetNew",t.COMBO="audio/effect/combo1",t.READY="audio/effect/ready",t.GO="audio/effect/go"}(n.ENUM_AUDIO_CLIP||(n.ENUM_AUDIO_CLIP={})),n.BaseScore=10,cc._RF.pop()},{}],EventManager:[function(t,e,n){"use strict";cc._RF.push(e,"a65afuRIFJN0aWClIJ1OR72","EventManager"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){this.eventMap=new Map}return t.getInstance=function(){return null===this._instance&&(this._instance=new this),this._instance},Object.defineProperty(t,"instance",{get:function(){return this.getInstance()},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n){this.eventMap.has(t)?this.eventMap.get(t).push({event:e,context:n}):this.eventMap.set(t,[{event:e,context:n}])},t.prototype.off=function(t,e,n){if(this.eventMap.has(t)){var o=this.eventMap.get(t),i=o.findIndex(function(t){return t.event==e&&t.context==n});i>-1&&o.splice(i,1)}},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(this.eventMap.has(t)){var o=this.eventMap.get(t);o.forEach(function(t){var n=t.event,o=t.context;o?n.apply(o,e):n(e)})}},t.prototype.clear=function(){this.eventMap.clear()},t._instance=null,t}();n.default=o,cc._RF.pop()},{}],GameData:[function(t,e,n){"use strict";cc._RF.push(e,"99616FD9LhHv76FPC2M4L7R","GameData"),Object.defineProperty(n,"__esModule",{value:!0}),n.BaseTime=n.MaxShowCount=n.InitDiamondCount=n.useFirstData=n.ToolDataLocal=n.ToolTip=n.ScoreBase=n.ScoreCoefficientByLevel=n.FactorLevelTsum=n.AnimalMaxLevel=n.BaseLevelScore=void 0,n.BaseLevelScore=5e3,n.AnimalMaxLevel=6,n.FactorLevelTsum=[400,600,700,800,900,1100],n.ScoreCoefficientByLevel=[1,1.1,1.2,1.4,1.5,1.6],n.ScoreBase=10,n.ToolTip="\u82b1\u8d39\u5b9d\u77f3\u83b7\u5f97\u6e38\u620f\u4e2d\u5956\u52b1",n.ToolDataLocal=[[1,"+\u5206\u6570","\u5c06\u603b\u5206\u63d0\u9ad810%",200]],n.useFirstData=!0,n.InitDiamondCount=1e3,n.MaxShowCount=40,n.BaseTime=5,cc._RF.pop()},{}],GameSettingUI:[function(t,e,n){"use strict";cc._RF.push(e,"23564gPxs1GE4mZp/JJbL0W","GameSettingUI");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../Data/Enum"),c=t("../../Manager/AudioManager"),s=t("../../Manager/EventManager"),l=t("./SettingUI"),u=cc._decorator,p=u.ccclass,d=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onBtnBackMenu=function(){c.default.instance.playBtn(),this.node.destroy(),cc.resources.release(r.GAME_Prefab.settingUI.url),s.default.instance.emit(r.ENUM_GAME_EVENT.QUIT_GAME)},e.prototype.onDestroy=function(){s.default.instance.emit(r.ENUM_GAME_EVENT.QUIT_SETTING)},a([p],e)}(l.default));n.default=d,cc._RF.pop()},{"../../Data/Enum":"Enum","../../Manager/AudioManager":"AudioManager","../../Manager/EventManager":"EventManager","./SettingUI":"SettingUI"}],GameUtils:[function(t,e,n){"use strict";cc._RF.push(e,"0826aHaRedL6IfAbOAfD5PH","GameUtils"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.formatNumber=function(t){if("number"!=typeof t)return"0";if(t<Math.pow(10,4))return String(t);var e=String(t/Math.pow(10,4));return e.substring(0,e.includes(".")?4:3).replace(/\.$/g,"")+"\u4e07"},t}();n.default=o,cc.Sprite.prototype.setSprite=function(t,e,n){var o=this;if(void 0===e&&(e=cc.resources),t){var i=e.get(t,cc.SpriteFrame);if(cc.isValid(i)){if(this.notDefaultSF)this.onReleaseSF();else{var a=this.onDestroy;this.onDestroy=function(){o.onReleaseSF(),a&&a.call(o)}}return this.spriteFrame=i,this.spriteFrame.addRef(),this.notDefaultSF=!0,void(n&&n())}e.load(t,cc.SpriteFrame,function(t,e){if(!t&&cc.isValid(o.node)){if(o.notDefaultSF)o.onReleaseSF();else{var i=o.onDestroy;o.onDestroy=function(){o.onReleaseSF(),i&&i.call(o)}}o.spriteFrame=e,o.spriteFrame.addRef(),o.notDefaultSF=!0,n&&n()}})}},cc.Sprite.prototype.onReleaseSF=function(){this.spriteFrame&&this.spriteFrame.refCount>0&&this.spriteFrame.decRef(),this.spriteFrame=null},cc._RF.pop()},{}],Game:[function(t,e,n){"use strict";cc._RF.push(e,"fb6d5Ze2YRPQY5gm5h//Lns","Game");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../Data/Enum"),c=t("../Data/GameData"),s=t("../Manager/AudioManager"),l=t("../Manager/EventManager"),u=t("../Manager/PoolManager"),p=t("../Manager/ResManager"),d=t("./AnimalCube/AnimalChoose"),h=t("./AnimalCube/AnimalCube"),f=t("./DataManager"),m=t("./GameUtils"),y=t("./UI/LevelShowUI"),g=cc._decorator,_=g.ccclass,v=g.property,E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bornAnimContainer=null,e.animChooseParent=null,e.animLineParent=null,e.animCube=null,e.touchNode=null,e.diamonLabel=null,e.scoreLabel=null,e.useAnimalIcon=null,e.timeProgress=null,e.energyProgress=null,e.energyProgressInBtn=null,e.readyNode=null,e.go=null,e.flyScoreLabel=null,e.flyScoreRoot=null,e.canUseTip=null,e.levelAnimal=[],e.animalDeleteCount=null,e.anims=[],e.animLength=0,e.selectedNodes=[],e.curTipNodes=[],e.tipNodes=[],e.minLinkCount=3,e.animLine=null,e.animChoose=null,e.tipDeleteTimeOut=null,e.isGaming=!1,e.gameMaxTime=0,e.gameTime=0,e}return i(e,t),e.prototype.onLoad=function(){this.preLoadRes(),this.readyNode.active=!1,this.go.active=!1,cc.director.getPhysicsManager().enabled=!0,cc.director.getCollisionManager().enabled=!0,this.touchNode.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.touchNode.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.touchNode.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.touchNode.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this),l.default.instance.on(r.ENUM_GAME_EVENT.GAME_PLAYSTART,this.onGameStart,this),l.default.instance.on(r.ENUM_GAME_EVENT.UPDATE_DIAMOND_COUNT,this.initDiamond,this),l.default.instance.on(r.ENUM_GAME_EVENT.QUIT_GAME,this.onEventQuitGame,this),l.default.instance.on(r.ENUM_GAME_EVENT.QUIT_SETTING,this.continueGame,this),l.default.instance.on(r.ENUM_GAME_EVENT.GAME_START,this.onEventQuitGame,this)},e.prototype.continueGame=function(){this.isGaming=!0},e.prototype.update=function(t){if(this.isGaming){this.gameTime+=t;var e=this.gameTime/this.gameMaxTime;e<=1?(e=Math.floor(e*=1e4),this.timeProgress.fillRange!=1-e/1e4&&(this.timeProgress.fillRange=1-e/1e4)):(this.isGaming=!1,this.onShowAnimLevel())}},e.prototype.preLoadRes=function(){cc.resources.preload(r.GAME_Prefab.animChoose,cc.Prefab),cc.resources.preload(r.GAME_Prefab.animLine,cc.Prefab)},e.prototype.onGameStart=function(){var t=this;this.initData(),this.initDiamond(),this.initCurrentScore(),this.initUseAnimalIcon(),this.initAnimalSkillProgress(),this.playStartAnimation(1),this.schedule(function(){t.spawnGroup()},.5)},e.prototype.initDiamond=function(){this.diamonLabel.string=""+f.default.instance.diamond},e.prototype.initCurrentScore=function(){this.scoreLabel.string=""+m.default.formatNumber(f.default.instance.currentScore)},e.prototype.initUseAnimalIcon=function(){var t=r.ANIMAL_TYPE_TEXTUREURL[f.default.instance.useAnimId];this.useAnimalIcon.setSprite(t)},e.prototype.initAnimalSkillProgress=function(){var t=f.default.instance.getAnimalDataById(f.default.instance.useAnimId),e=f.default.instance.currentDeleteAnimal/t.skillNeedCube;this.energyProgress.fillRange=e>1?1:e,this.energyProgressInBtn.fillRange=e>1?1:e,this.canUseTip.active=e>=1},e.prototype.initData=function(){this.isGaming=!1,this.animLine=new Map,this.animChoose=new Map,this.anims=[],this.animLength=0,this.selectedNodes=[],this.curTipNodes=[],this.tipNodes=[],this.gameMaxTime=c.BaseTime,f.default.instance.currentScore=0,f.default.instance.currentDeleteAnimal=0,this.bornAnimContainer.removeAllChildren(),this.animLineParent.removeAllChildren(),this.animChooseParent.removeAllChildren(),this.levelAnimal=[],this.animalDeleteCount=new Map,this.levelAnimal.push(f.default.instance.useAnimId),this.animalDeleteCount.set(f.default.instance.useAnimId,0);for(var t=[],e=1;e<=12;e++)f.default.instance.useAnimId!=e&&t.push(e);do{var n=Math.floor(Math.random()*t.length);this.levelAnimal.push(t[n]),this.animalDeleteCount.set(t[n],0),t.splice(n,1)}while(this.levelAnimal.length<5)},e.prototype.onBtnJump=function(){if(s.default.instance.playBtn(),l.default.instance.emit(r.ENUM_GAME_EVENT.GAME_BTN_JUMP_ITEM),this.tipDeleteTimeOut){clearTimeout(this.tipDeleteTimeOut),this.tipDeleteTimeOut=null;for(var t=0;t<this.tipNodes.length;t++)this.tipNodes[t].getComponent(h.default).clearTip();this.tipNodes=[]}},e.prototype.onBtnSetting=function(){s.default.instance.playBtn(),this.isGaming=!1,p.default.instance.loadRes(r.GAME_Prefab.gameSettingUI.url).then(function(t){var e=cc.instantiate(t);e.parent=cc.find("Canvas"),e.zIndex=r.GAME_Prefab.gameSettingUI.zIndex})},e.prototype.onBtnUseSkill=function(){var t=f.default.instance.getAnimalDataById(f.default.instance.useAnimId);if(f.default.instance.currentDeleteAnimal>=t.skillNeedCube)switch(s.default.instance.playBtn(),f.default.instance.currentDeleteAnimal-=t.skillNeedCube,this.initAnimalSkillProgress(),Number(t.id)){case r.ANIMAL_TYPE.Bear:this.gameMaxTime=c.BaseTime+3;break;case r.ANIMAL_TYPE.Kitty:this.gameMaxTime=c.BaseTime+5;break;case r.ANIMAL_TYPE.Frog:this.gameMaxTime=c.BaseTime+8;break;case 4:this.gameMaxTime=c.BaseTime+10;break;case 5:this.gameMaxTime=c.BaseTime+12;break;case 6:this.gameMaxTime=c.BaseTime+15;break;case 7:this.gameMaxTime=c.BaseTime+20;break;case 8:this.gameMaxTime=c.BaseTime+15;break;case 9:this.gameMaxTime=c.BaseTime+30;break;case 10:case 11:case 12:this.gameMaxTime=c.BaseTime+3}},e.prototype.spawnGroup=function(){for(var t=this,e=0;e<4;e++){if(this.animLength>c.MaxShowCount)return this.unscheduleAllCallbacks(),void(this.isGaming||(this.isGaming=!0,this.playStartAnimation(2)));var n=Math.random()<.05?1.6:.8,o=this.spawnAnimal(this.levelAnimal,n);o.name=this.anims.length+"",o.setPosition(cc.v2((Math.random()-.5)*(this.bornAnimContainer.width-60),0)),this.anims.push(o),1.6==n?this.animLength+=2:this.animLength++}this.anims.length<c.MaxShowCount&&this.scheduleOnce(function(){t.spawnGroup()},.5)},e.prototype.spawnAnimal=function(t,e){var n=t[Math.floor(Math.random()*t.length)],o=u.default.instance.getNode(this.animCube,this.bornAnimContainer,r.GAME_POOL.ANIMAL_POOL);return o.angle=360*Math.random(),o.getComponent(h.default).init(e,n),o},e.prototype.onTouchStart=function(t){if(this.isGaming){if(this.tipDeleteTimeOut){clearTimeout(this.tipDeleteTimeOut),this.tipDeleteTimeOut=null;for(var e=0;e<this.tipNodes.length;e++)this.tipNodes[e].getComponent(h.default).clearTip();this.tipNodes=[]}this.tipDeleteTimeOut=null;var n=this.getNodeUnderTouch(t);n&&this.addToSelection(n)}},e.prototype.onTouchMove=function(t){var e=this.getNodeUnderTouch(t);if(e){var n=this.selectedNodes[this.selectedNodes.length-1];if(this.selectedNodes.length>1&&e.uuid===this.selectedNodes[this.selectedNodes.length-2].uuid)return this.removeFromSelection(n),void(this.selectedNodes.length>1&&e.getComponent(h.default).chooseAni());this.curTipNodes.includes(e)&&this.checkLineClear(e,n)&&!this.selectedNodes.includes(e)&&(this.addToSelection(e),e.getComponent(h.default).chooseAni())}},e.prototype.onTouchEnd=function(){var t=this;this.clearLine(),this.selectedNodes.length>=this.minLinkCount?this.eliminateSelection():this.clearSelection(),this.clearTipsAnimCube(),this.tipDeleteTimeOut&&(clearTimeout(this.tipDeleteTimeOut),this.tipDeleteTimeOut=null),this.tipDeleteTimeOut=setTimeout(function(){t.findCanClear()},5e3)},e.prototype.getNodeUnderTouch=function(t){for(var e=t.getLocation(),n=null,o=0,i=this.anims;o<i.length;o++){var a=i[o];if(a){var r=a.convertToNodeSpaceAR(e),c=a.getComponent(cc.PhysicsCircleCollider).offset,s=a.getComponent(cc.PhysicsCircleCollider).radius;if(r.sub(c).mag()<=s){n=a;break}}}return n},e.prototype.clearSelection=function(){for(var t=0,e=this.selectedNodes;t<e.length;t++){var n=e[t];this.animChoose.has(n.uuid)&&(this.animChoose.get(n.uuid).getComponent(d.default).setTarget(null),u.default.instance.putNode(this.animChoose.get(n.uuid),r.GAME_POOL.ANIMAL_CHOOSE),this.animChoose.delete(n.uuid)),n.getComponent(h.default).setChoose(!1)}this.selectedNodes=[]},e.prototype.clearTipsAnimCube=function(){for(var t=0;t<this.curTipNodes.length;t++){var e=this.curTipNodes[t];cc.isValid(e)&&e.getComponent(h.default).clearLight()}this.curTipNodes=[]},e.prototype.addTipsAnimCube=function(t){this.curTipNodes=this.getGraphGroup(t,this.anims);for(var e=0;e<this.curTipNodes.length;e++){var n=this.curTipNodes[e];cc.isValid(n)&&n.getComponent(h.default).showLight()}},e.prototype.eliminateSelection=function(){var t,e=this;if(!(this.selectedNodes.length<=0)){for(var n=0,o=0;o<this.selectedNodes.length;o++){var i=this.selectedNodes[o],a=i.getComponent(h.default).animType;if(1.6==i.scale?n+=2:n++,this.animalDeleteCount.has(a)){var c=this.animalDeleteCount.get(a)+n;this.animalDeleteCount.set(a,c)}}f.default.instance.currentDeleteAnimal+=n,this.initAnimalSkillProgress();var s=null===(t=this.selectedNodes[0])||void 0===t?void 0:t.getComponent(h.default).animType,l=this.getScore(n,s),p=this.selectedNodes[this.selectedNodes.length-1],m=p.parent.convertToWorldSpaceAR(p.position);this.flyScore(l,m,function(){f.default.instance.currentScore+=l,e.initCurrentScore()});for(var y=function(t){var n=g.selectedNodes[t];g.animChoose.has(n.uuid)&&(g.animChoose.get(n.uuid).getChildByName("diamond").active?g.flyDiamond(t,g.animChoose.get(n.uuid).getChildByName("diamond"),function(){e.animChoose.get(n.uuid).getComponent(d.default).setTarget(null),u.default.instance.putNode(e.animChoose.get(n.uuid),r.GAME_POOL.ANIMAL_CHOOSE),e.animChoose.delete(n.uuid),f.default.instance.addDiamond(1)}):(g.animChoose.get(n.uuid).getComponent(d.default).setTarget(null),u.default.instance.putNode(g.animChoose.get(n.uuid),r.GAME_POOL.ANIMAL_CHOOSE),g.animChoose.delete(n.uuid))),g.anims=g.anims.filter(function(t){return t.uuid!=n.uuid});var o=g.energyProgressInBtn.node.parent.convertToWorldSpaceAR(g.energyProgressInBtn.node.position);n.getComponent(h.default).remove(t,o),1.6==n.scale?g.animLength-=2:g.animLength--},g=this,_=0;_<this.selectedNodes.length;_++)y(_);this.selectedNodes=[],this.spawnGroup()}},e.prototype.addToSelection=function(t){var e=this;s.default.instance.playBtn(),this.selectedNodes.length>1&&this.selectedNodes[this.selectedNodes.length-1].getComponent(h.default).switchMaterial(!1),this.selectedNodes.push(t);for(var n=0,o=0;o<this.selectedNodes.length;o++)1.6==this.selectedNodes[o].scale?n+=2:n++;this.drawLine(),t.getComponent(h.default).setChoose(!0),this.animChoose.has(t.uuid)?(this.animChoose.get(t.uuid).active=!0,this.animChoose.get(t.uuid).setPosition(t.position)):cc.resources.load(r.GAME_Prefab.animChoose,cc.Prefab,function(o,i){if(!o){var a=u.default.instance.getNode(i,e.animChooseParent,r.GAME_POOL.ANIMAL_CHOOSE);e.animChoose.set(t.uuid,a),a.getChildByName("diamond").active=n>2,a.getChildByName("light").active=n<=2,a.getComponent(d.default).setTarget(t)}}),this.clearTipsAnimCube(),this.addTipsAnimCube(t)},e.prototype.removeFromSelection=function(t){s.default.instance.playBtn(),this.selectedNodes.pop(),t.getComponent(h.default).setChoose(!1),this.animChoose.has(t.uuid)&&(this.animChoose.get(t.uuid).getComponent(d.default).setTarget(null),u.default.instance.putNode(this.animChoose.get(t.uuid),r.GAME_POOL.ANIMAL_CHOOSE),this.animChoose.delete(t.uuid)),this.clearTipsAnimCube(),this.selectedNodes.length>0&&this.addTipsAnimCube(this.selectedNodes[this.selectedNodes.length-1]),this.drawLine()},e.prototype.findCanClear=function(){var t;if(!(this.selectedNodes.length>0||this.tipNodes.length>0)){var e=this.anims,n=this.findConnectedSameType(e,3);if(!(n.length<2)){(t=this.tipNodes).push.apply(t,n);for(var o=0;o<n.length;o++)n[o].getComponent(h.default).showTip()}}},e.prototype.findConnectedSameType=function(t,e){for(var n={},o=0,i=t;o<i.length;o++)n[r=(m=i[o]).getComponent(h.default).animType]||(n[r]=[]),n[r].push(m);var a=[];for(var r in n){for(var c=n[r],s={},l=0;l<c.length;l++){s[c[l].uuid]=[];for(var u=0;u<c.length;u++)l!==u&&this.checkLineClear(c[l],c[u])&&!c[u].getComponent(h.default).getChooseType()&&s[c[l].uuid].push(c[u])}for(var p=new Set,d=0,f=c;d<f.length;d++){var m=f[d];if(!p.has(m.uuid)){var y=[];if(this.dfs(m,s,p,y),y.length>e)return y}}}return a},e.prototype.getGraphGroup=function(t,e){for(var n={},o=0,i=e;o<i.length;o++){var a=i[o],r=a.getComponent(h.default).animType;n[r]||(n[r]=[]),n[r].push(a)}for(var c=n[t.getComponent(h.default).animType],s={},l=0;l<c.length;l++){s[c[l].uuid]=[];for(var u=0;u<c.length;u++)l!==u&&this.checkLineClear(c[l],c[u])&&!c[u].getComponent(h.default).getChooseType()&&s[c[l].uuid].push(c[u])}var p=new Set,d=[];return this.dfs(t,s,p,d),d},e.prototype.dfs=function(t,e,n,o){n.add(t.uuid),o.push(t);for(var i=0,a=e[t.uuid];i<a.length;i++){var r=a[i];n.has(r.uuid)||this.dfs(r,e,n,o)}},e.prototype.checkLineClear=function(t,e){for(var n=cc.director.getPhysicsManager(),o=t.convertToWorldSpaceAR(cc.v2(0,0)),i=e.convertToWorldSpaceAR(cc.v2(0,0)),a=0,r=n.rayCast(o,i,cc.RayCastType.All);a<r.length;a++){var c=r[a].collider.node;if(c!==t&&c!==e)return!1}return!0},e.prototype.drawLine=function(t){var e=this;if(void 0===t&&(t=cc.Color.WHITE),this.selectedNodes.length<2)this.clearLine();else{this.clearLine();for(var n=function(n){var i=o.selectedNodes[n],a=o.selectedNodes[n+1],c=cc.v2(i.position),s=cc.v2(a.position),l=c.sub(s),p=Math.atan2(l.y,l.x),d=cc.misc.radiansToDegrees(p),h=l.mag();if(o.animLine.has(a.uuid)){var f=o.animLine.get(a.uuid),m=i.parent.convertToWorldSpaceAR(i.position);m=o.animLineParent.convertToNodeSpaceAR(m),f.setPosition(m),f.angle=0,f.angle=d,f.width=h,f.color=t,f.active=!0,o.animLine.set(a.uuid,f)}else cc.resources.load(r.GAME_Prefab.animLine,cc.Prefab,function(n,o){if(!n){var c=u.default.instance.getNode(o,e.animLineParent,r.GAME_POOL.ANIMAL_LINE);c.angle=0;var s=i.parent.convertToWorldSpaceAR(i.position);s=e.animLineParent.convertToNodeSpaceAR(s),c.setPosition(s),c.angle=d,c.width=h,c.color=t,c.active=!0,e.animLine.set(a.uuid,c)}})},o=this,i=0;i<this.selectedNodes.length-1;i++)n(i)}},e.prototype.clearLine=function(){var t;(null===(t=this.animLine)||void 0===t?void 0:t.size)>0&&(this.animLine.forEach(function(t){u.default.instance.putNode(t,r.GAME_POOL.ANIMAL_LINE)}),this.animLine.clear())},e.prototype.flyDiamond=function(t,e,n){var o=e.parent.convertToNodeSpaceAR(this.diamonLabel.node.parent.convertToWorldSpaceAR(this.diamonLabel.node.position));cc.tween(e).delay(.1*t).call(function(){e.setScale(1.5)}).to(.4,{position:o}).call(function(){e.setPosition(cc.Vec3.ZERO),e.setScale(1),n&&n()}).start()},e.prototype.flyScore=function(t,e,n){var o=u.default.instance.getNode(this.flyScoreLabel,this.flyScoreRoot,r.GAME_POOL.UI_SCORE_FLY);o.setPosition(this.flyScoreRoot.convertToNodeSpaceAR(e)),o.scale=1,o.opacity=0,o.getComponent(cc.Label).string=""+t;var i=this.flyScoreRoot.convertToNodeSpaceAR(this.scoreLabel.node.parent.convertToWorldSpaceAR(this.scoreLabel.node.position));cc.tween(o).to(.2,{opacity:255}).delay(.5).to(.18,{position:i,scale:.2}).call(function(){u.default.instance.putNode(o,r.GAME_POOL.UI_SCORE_FLY),n&&n()}).start()},e.prototype.getScore=function(t,e){if(f.default.instance.getAnimalDataById(e)){var n=f.default.instance.getAnimalDataById(e).level;return t*r.BaseScore*c.ScoreCoefficientByLevel[n-1]}return 0},e.prototype.playStartAnimation=function(t){var e=this;this.readyNode.stopAllActions(),this.go.stopAllActions(),1==t?(this.readyNode.active=!0,this.readyNode.y=.5*cc.winSize.height,s.default.instance.playSound(r.ENUM_AUDIO_CLIP.READY),cc.tween(this.readyNode).to(.3,{y:0},{easing:"quadIn"}).to(.2,{y:40},{easing:"quadOut"}).to(.15,{y:0},{easing:"quadIn"}).to(.1,{y:0+40/3},{easing:"quadOut"}).to(.08,{y:0},{easing:"quadIn"}).start()):2==t&&(this.go.active=!0,this.go.opacity=0,cc.tween(this.readyNode).to(.08,{opacity:0,scale:0}).call(function(){e.readyNode.active=!1}).start(),cc.tween(this.go).delay(.08).call(function(){s.default.instance.playSound(r.ENUM_AUDIO_CLIP.GO)}).to(.2,{opacity:255,scale:1.2}).to(.2,{scale:1}).delay(.5).to(.3,{opacity:0}).call(function(){e.go.active=!1}).start())},e.prototype.onDestroy=function(){l.default.instance.off(r.ENUM_GAME_EVENT.GAME_PLAYSTART,this.onGameStart,this),l.default.instance.off(r.ENUM_GAME_EVENT.UPDATE_DIAMOND_COUNT,this.initDiamond,this),l.default.instance.off(r.ENUM_GAME_EVENT.QUIT_GAME,this.onEventQuitGame,this),l.default.instance.off(r.ENUM_GAME_EVENT.QUIT_SETTING,this.continueGame,this),l.default.instance.off(r.ENUM_GAME_EVENT.GAME_START,this.onEventQuitGame,this),this.tipDeleteTimeOut&&(clearTimeout(this.tipDeleteTimeOut),this.tipDeleteTimeOut=null)},e.prototype.onEventQuitGame=function(){this.node.destroy()},e.prototype.onShowAnimLevel=function(){var t=this;p.default.instance.loadRes(r.GAME_Prefab.levelshowUI.url).then(function(e){var n=cc.instantiate(e);n.parent=t.node,n.zIndex=r.GAME_Prefab.levelshowUI.zIndex,n.getComponent(y.default).initUI(t.animalDeleteCount)})},a([v(cc.Node)],e.prototype,"bornAnimContainer",void 0),a([v(cc.Node)],e.prototype,"animChooseParent",void 0),a([v(cc.Node)],e.prototype,"animLineParent",void 0),a([v(cc.Prefab)],e.prototype,"animCube",void 0),a([v(cc.Node)],e.prototype,"touchNode",void 0),a([v(cc.Label)],e.prototype,"diamonLabel",void 0),a([v(cc.Label)],e.prototype,"scoreLabel",void 0),a([v(cc.Sprite)],e.prototype,"useAnimalIcon",void 0),a([v(cc.Sprite)],e.prototype,"timeProgress",void 0),a([v(cc.Sprite)],e.prototype,"energyProgress",void 0),a([v(cc.Sprite)],e.prototype,"energyProgressInBtn",void 0),a([v(cc.Node)],e.prototype,"readyNode",void 0),a([v(cc.Node)],e.prototype,"go",void 0),a([v(cc.Prefab)],e.prototype,"flyScoreLabel",void 0),a([v(cc.Node)],e.prototype,"flyScoreRoot",void 0),a([v(cc.Node)],e.prototype,"canUseTip",void 0),a([_],e)}(cc.Component);n.default=E,cc._RF.pop()},{"../Data/Enum":"Enum","../Data/GameData":"GameData","../Manager/AudioManager":"AudioManager","../Manager/EventManager":"EventManager","../Manager/PoolManager":"PoolManager","../Manager/ResManager":"ResManager","./AnimalCube/AnimalChoose":"AnimalChoose","./AnimalCube/AnimalCube":"AnimalCube","./DataManager":"DataManager","./GameUtils":"GameUtils","./UI/LevelShowUI":"LevelShowUI"}],LevelShowUI:[function(t,e,n){"use strict";cc._RF.push(e,"4e3fbpCmu5GLZexg/tyMJgu","LevelShowUI");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../Data/Enum"),c=t("../../Manager/AudioManager"),s=t("../../Manager/EventManager"),l=t("./Item/AnimalLevelItem"),u=cc._decorator,p=u.ccclass,d=u.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.showRoot=null,e.showLevelItem=null,e}return i(e,t),e.prototype.initUI=function(t){var e=this;this.showRoot.removeAllChildren(),t.forEach(function(t,n){var o=cc.instantiate(e.showLevelItem);o.parent=e.showRoot,o.getComponent(l.default).initUI(n,t),e.showRoot.childrenCount%2==1?o.x=-500:o.x=500,cc.tween(o).to(.15,{x:0}).start()})},e.prototype.onBtnClose=function(){c.default.instance.playBtn(),this.quitAni()},e.prototype.quitAni=function(){for(var t=this,e=0;e<this.showRoot.childrenCount;e++){var n=this.showRoot.children[e];n.stopAllActions();var o;o=e%2==0?-500:500,cc.tween(n).to(.15,{x:o}).start()}this.scheduleOnce(function(){t.node.destroy(),s.default.instance.emit(r.ENUM_GAME_EVENT.SHOW_GAMESCORE)},.15)},a([d(cc.Node)],e.prototype,"showRoot",void 0),a([d(cc.Prefab)],e.prototype,"showLevelItem",void 0),a([p],e)}(cc.Component);n.default=h,cc._RF.pop()},{"../../Data/Enum":"Enum","../../Manager/AudioManager":"AudioManager","../../Manager/EventManager":"EventManager","./Item/AnimalLevelItem":"AnimalLevelItem"}],LoadSceneUI:[function(t,e,n){"use strict";cc._RF.push(e,"8de70Kr0zRIqIQNzKg0X8eI","LoadSceneUI");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.logo=null,e.catchNode=null,e.endCB=null,e}return i(e,t),e.prototype.onLoad=function(){this.loadAni(),cc.game.addPersistRootNode(this.node)},e.prototype.loadAni=function(){var t=this;this.logo.stopAllActions(),this.catchNode.stopAllActions();var e=.5*cc.winSize.height+300;this.logo.setPosition(cc.v3(0,e)),this.catchNode.setPosition(cc.v3(0,e+370)),cc.tween(this.logo).to(.5,{y:200},{easing:"quadIn"}).delay(1.2).to(.5,{y:e}).start(),cc.tween(this.catchNode).delay(.7).to(.5,{y:570},{easing:"quadIn"}).call(function(){cc.isValid(t.catchNode)&&cc.isValid(t.catchNode.getComponent(cc.Animation))&&t.catchNode.getComponent(cc.Animation).play("catch")}).delay(.5).to(.5,{y:e+370}).call(function(){t.endCB&&t.endCB(),t.node.destroy()}).start()},a([s(cc.Node)],e.prototype,"logo",void 0),a([s(cc.Node)],e.prototype,"catchNode",void 0),a([c],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],LoadUI:[function(t,e,n){"use strict";cc._RF.push(e,"078c5LhouxOgbbVIoGZmvAh","LoadUI");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=(r.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.onLoad=function(){this.loadingAni()},e.prototype.loadingAni=function(){var t=this.node.getChildByName("1"),e=this.node.getChildByName("2");t.stopAllActions,e.stopAllActions,cc.tween(t).repeatForever(cc.tween().to(2,{angle:180}).to(2,{angle:360}).to(0,{angle:0})).start(),cc.tween(e).repeatForever(cc.tween().to(2,{angle:-180}).to(2,{angle:-360}).to(0,{angle:0})).start()},a([c],e)}(cc.Component));n.default=s,cc._RF.pop()},{}],MainBgUI:[function(t,e,n){"use strict";cc._RF.push(e,"2f1bc0V1QNLLaL8heMVfmeY","MainBgUI");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=r.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.yunLeft=null,e.yunRight=null,e}return i(e,t),e.prototype.onLoad=function(){this.yunAni()},e.prototype.yunAni=function(){this.yunLeft.stopAllActions(),this.yunRight.stopAllActions();var t=.5*cc.winSize.height-100,e=.5*cc.winSize.height-200;this.yunLeft.y=t,this.yunRight.y=t,cc.tween(this.yunLeft).repeatForever(cc.tween().to(10,{y:e}).to(10,{y:t})).start(),cc.tween(this.yunRight).repeatForever(cc.tween().to(10,{y:e}).to(10,{y:t})).start()},a([s(cc.Node)],e.prototype,"yunLeft",void 0),a([s(cc.Node)],e.prototype,"yunRight",void 0),a([c],e)}(cc.Component);n.default=l,cc._RF.pop()},{}],Main:[function(t,e,n){"use strict";cc._RF.push(e,"66a689LYaRFJKskQx/Xo19r","Main");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../Data/Enum"),c=t("../Manager/AudioManager"),s=t("../Manager/EventManager"),l=t("../Manager/ResManager"),u=t("./DataManager"),p=t("./UI/LoadSceneUI"),d=t("./UI/ReadyUI"),h=t("./UI/ScoreUI"),f=t("./UI/StartUI"),m=cc._decorator,y=m.ccclass,g=m.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loadUI=null,e.mainBgUI=null,e}return i(e,t),e.prototype.onLoad=function(){this.reloadRes(),s.default.instance.on(r.ENUM_GAME_EVENT.GAME_START,this.toGame,this),s.default.instance.on(r.ENUM_GAME_EVENT.QUIT_GAME,this.gameToMain,this),s.default.instance.on(r.ENUM_GAME_EVENT.SHOW_GAMESCORE,this.showScoreUI,this)},e.prototype.reloadRes=function(){var t=this;this.loadingAni();var e=!1,n=!1,o=!1;cc.resources.preload([r.GAME_Prefab.mainBg.url,r.GAME_Prefab.startUI.url,r.GAME_Prefab.readyUI.url,r.GAME_Prefab.loadSceneUI.url,r.GAME_Prefab.loadUI.url,r.JsonUrl.animalJson,"pic/animal"],function(){},function(){e=!0,t.checkLogin(e,n,o)}),cc.director.preloadScene("game",function(){},function(){n=!0,t.checkLogin(e,n,o)}),u.default.instance.init(function(){o=!0,t.checkLogin(e,n,o)}),u.default.instance.gameState=0},e.prototype.checkLogin=function(t,e,n){t&&e&&n&&(this.stopLoading(),this.startMain())},e.prototype.startMain=function(){var t=this;l.default.instance.loadRes(r.GAME_Prefab.mainBg.url).then(function(e){if(2!=u.default.instance.gameState){var n=cc.instantiate(e);n.parent=t.node,n.zIndex=r.GAME_Prefab.mainBg.zIndex,t.mainBgUI=n}}),l.default.instance.loadRes(r.GAME_Prefab.startUI.url).then(function(e){var n=cc.instantiate(e);n.parent=t.node,n.zIndex=r.GAME_Prefab.startUI.zIndex,n.getComponent(f.default).onAwake(),n.getComponent(f.default).quitCB=t.toReadyUI.bind(t)}),u.default.instance.gameState=1,c.default.instance.playMusic()},e.prototype.toReadyUI=function(){var t=this;l.default.instance.loadRes(r.GAME_Prefab.readyUI.url).then(function(e){var n=cc.instantiate(e);n.parent=t.node,n.zIndex=r.GAME_Prefab.readyUI.zIndex,n.getComponent(d.default).onAwake()})},e.prototype.toGame=function(){var t=this;u.default.instance.gameState=0,c.default.instance.playMusic(),cc.resources.preload([r.GAME_Prefab.gameUI.url]),l.default.instance.loadRes(r.GAME_Prefab.loadSceneUI.url).then(function(e){var n=cc.instantiate(e);n.parent=t.node,n.zIndex=r.GAME_Prefab.loadSceneUI.zIndex,t.releaseMainRes(),l.default.instance.loadRes(r.GAME_Prefab.gameUI.url).then(function(e){var n=cc.instantiate(e);n.parent=t.node,n.zIndex=r.GAME_Prefab.gameUI.zIndex}),n.getComponent(p.default).endCB=function(){s.default.instance.emit(r.ENUM_GAME_EVENT.GAME_PLAYSTART),u.default.instance.gameState=2,c.default.instance.playMusic()}})},e.prototype.gameToMain=function(){var t=this;u.default.instance.gameState=0,c.default.instance.playMusic(),cc.resources.preload([r.GAME_Prefab.mainBg.url,r.GAME_Prefab.readyUI.url]),l.default.instance.loadRes(r.GAME_Prefab.loadSceneUI.url).then(function(e){var n=cc.instantiate(e);n.parent=t.node,n.zIndex=r.GAME_Prefab.loadSceneUI.zIndex,n.getComponent(p.default).endCB=function(){t.toReadyUI(),u.default.instance.gameState=1,c.default.instance.playMusic(),l.default.instance.loadRes(r.GAME_Prefab.mainBg.url).then(function(e){if(2!=u.default.instance.gameState){var n=cc.instantiate(e);n.parent=t.node,n.zIndex=r.GAME_Prefab.mainBg.zIndex,t.mainBgUI=n}})}})},e.prototype.showScoreUI=function(){var t=this;l.default.instance.loadRes(r.GAME_Prefab.scoreUI.url).then(function(e){var n=cc.instantiate(e);n.parent=t.node,n.zIndex=r.GAME_Prefab.scoreUI.zIndex,n.getComponent(h.default).initUI()})},e.prototype.releaseMainRes=function(){cc.isValid(this.mainBgUI)&&this.mainBgUI.destroy(),cc.resources.release(r.GAME_Prefab.mainBg.url)},e.prototype.loadingAni=function(){this.loadUI.active=!0;var t=this.loadUI.getChildByName("1"),e=this.loadUI.getChildByName("2");t.stopAllActions,e.stopAllActions,cc.tween(t).repeatForever(cc.tween().to(2,{angle:180}).to(2,{angle:360}).to(0,{angle:0})).start(),cc.tween(e).repeatForever(cc.tween().to(2,{angle:-180}).to(2,{angle:-360}).to(0,{angle:0})).start()},e.prototype.stopLoading=function(){this.loadUI.active=!1;var t=this.loadUI.getChildByName("1"),e=this.loadUI.getChildByName("2");t.stopAllActions,e.stopAllActions},e.prototype.onDestroy=function(){s.default.instance.off(r.ENUM_GAME_EVENT.QUIT_GAME,this.gameToMain,this),s.default.instance.off(r.ENUM_GAME_EVENT.GAME_START,this.toGame,this),s.default.instance.off(r.ENUM_GAME_EVENT.SHOW_GAMESCORE,this.showScoreUI,this)},a([g(cc.Node)],e.prototype,"loadUI",void 0),a([y],e)}(cc.Component);n.default=_,cc._RF.pop()},{"../Data/Enum":"Enum","../Manager/AudioManager":"AudioManager","../Manager/EventManager":"EventManager","../Manager/ResManager":"ResManager","./DataManager":"DataManager","./UI/LoadSceneUI":"LoadSceneUI","./UI/ReadyUI":"ReadyUI","./UI/ScoreUI":"ScoreUI","./UI/StartUI":"StartUI"}],PoolManager:[function(t,e,n){"use strict";cc._RF.push(e,"63c79rdzlpPLK5nZD81cOq2","PoolManager"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){this.dictPool=new Map}return t.getInstance=function(){return null===this._instance&&(this._instance=new this),this._instance},Object.defineProperty(t,"instance",{get:function(){return this.getInstance()},enumerable:!1,configurable:!0}),t.prototype.getNode=function(t,e,n){void 0===n&&(n="default");var o=null;if(this.dictPool.has(n))o=(i=this.dictPool.get(n)).size()>0?i.get():cc.instantiate(t);else{var i=new cc.NodePool;this.dictPool.set(n,i),o=cc.instantiate(t)}return o.parent=e,o},t.prototype.putNode=function(t,e){void 0===e&&(e="default");var n=null;this.dictPool.has(e)?n=this.dictPool.get(e):(n=new cc.NodePool,this.dictPool.set(e,n)),n.put(t)},t.prototype.clearPool=function(t){if(t){var e=this.dictPool.get(t);e&&e.clear(),this.dictPool.delete(t)}else cc.warn("PoolManager.clearPool: name is null")},t.prototype.clearAll=function(){this.dictPool.forEach(function(t){t.clear()}),this.dictPool.clear()},t._instance=null,t}();n.default=o,cc._RF.pop()},{}],ReadyAnimalItem:[function(t,e,n){"use strict";cc._RF.push(e,"26f66lc8cVIto3S93XIK1Wx","ReadyAnimalItem");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../../Data/Enum"),c=t("../../../Manager/EventManager"),s=t("../../DataManager"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.progressSpr=null,e.chooseNode=null,e.lock=null,e.cost=null,e.lvLabel=null,e.id=0,e}return i(e,t),e.prototype.onLoad=function(){c.default.instance.on(r.ENUM_GAME_EVENT.READYUI_CHOOSE_ITEM,this.chooseItem,this),c.default.instance.on(r.ENUM_GAME_EVENT.READYUI_REFRESH_ITEM,this.refeshItem,this)},e.prototype.refeshItem=function(t){this.id==t&&this.init(s.default.instance.getAnimalDataById(t))},e.prototype.init=function(t){var e=t.lockMoney>0&&t.isLock,n=r.ANIMAL_TYPE_TEXTUREURL[t.id]+(e?"_lock":"");this.lock.active=e,this.icon.setSprite(n),this.progressSpr.fillRange=t.expValue,this.id=t.id,this.cost.node.active=e,this.lvLabel.node.active=!e,this.cost.string=""+t.lockMoney,this.lvLabel.string="\u7b49\u7ea7 "+t.level},e.prototype.chooseItem=function(t){this.chooseNode.active=t==this.id},e.prototype.onBtnChoose=function(){c.default.instance.emit(r.ENUM_GAME_EVENT.READYUI_CHOOSE_ITEM,this.id)},e.prototype.onDestroy=function(){c.default.instance.off(r.ENUM_GAME_EVENT.READYUI_CHOOSE_ITEM,this.chooseItem,this),c.default.instance.off(r.ENUM_GAME_EVENT.READYUI_REFRESH_ITEM,this.refeshItem,this)},a([p(cc.Sprite)],e.prototype,"icon",void 0),a([p(cc.Sprite)],e.prototype,"progressSpr",void 0),a([p(cc.Node)],e.prototype,"chooseNode",void 0),a([p(cc.Node)],e.prototype,"lock",void 0),a([p(cc.Label)],e.prototype,"cost",void 0),a([p(cc.Label)],e.prototype,"lvLabel",void 0),a([u],e)}(cc.Component);n.default=d,cc._RF.pop()},{"../../../Data/Enum":"Enum","../../../Manager/EventManager":"EventManager","../../DataManager":"DataManager"}],ReadyToolItem:[function(t,e,n){"use strict";cc._RF.push(e,"c5c93fVYz9MDLt1Eiyp4unw","ReadyToolItem");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../../Data/Enum"),c=t("../../../Manager/EventManager"),s=t("../../DataManager"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.chooseNode=null,e.haveToolBg1=null,e.haveToolBg2=null,e.noToolBg1=null,e.noToolBg2=null,e.nameLabel=null,e.diamondCost=null,e.id=0,e}return i(e,t),e.prototype.onLoad=function(){c.default.instance.on(r.ENUM_GAME_EVENT.READYUI_CHOOSE_TOOLITEM,this.chooseItem,this),c.default.instance.on(r.ENUM_GAME_EVENT.READYUI_REFRESH_TOOLITEM,this.refeshItem,this)},e.prototype.refeshItem=function(t){this.id==t&&this.init(s.default.instance.getToolDataById(t))},e.prototype.init=function(t){this.id=t.id,this.nameLabel.string=t.name,this.diamondCost.string=t.diamondCost+"";var e=r.TOOL_TYPE_TEXTUREURL[t.id];this.noToolBg1.active=t.countNumber<=0,this.noToolBg2.active=t.countNumber<=0,this.haveToolBg1.active=t.countNumber>0,this.haveToolBg2.active=t.countNumber>0,this.icon.setSprite(e)},e.prototype.chooseItem=function(t){this.chooseNode.active=t==this.id},e.prototype.onBtnChoose=function(){c.default.instance.emit(r.ENUM_GAME_EVENT.READYUI_CHOOSE_TOOLITEM,this.id)},e.prototype.onDestroy=function(){c.default.instance.off(r.ENUM_GAME_EVENT.READYUI_CHOOSE_TOOLITEM,this.chooseItem,this),c.default.instance.off(r.ENUM_GAME_EVENT.READYUI_REFRESH_TOOLITEM,this.refeshItem,this)},a([p(cc.Sprite)],e.prototype,"icon",void 0),a([p(cc.Node)],e.prototype,"chooseNode",void 0),a([p(cc.Node)],e.prototype,"haveToolBg1",void 0),a([p(cc.Node)],e.prototype,"haveToolBg2",void 0),a([p(cc.Node)],e.prototype,"noToolBg1",void 0),a([p(cc.Node)],e.prototype,"noToolBg2",void 0),a([p(cc.Label)],e.prototype,"nameLabel",void 0),a([p(cc.Label)],e.prototype,"diamondCost",void 0),a([u],e)}(cc.Component);n.default=d,cc._RF.pop()},{"../../../Data/Enum":"Enum","../../../Manager/EventManager":"EventManager","../../DataManager":"DataManager"}],ReadyUI:[function(t,e,n){"use strict";cc._RF.push(e,"28d476iNIRGR6CDkbq17X0A","ReadyUI");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../Data/Enum"),c=t("../../Data/GameData"),s=t("../../Manager/AudioManager"),l=t("../../Manager/EventManager"),u=t("../../Manager/ResManager"),p=t("../DataManager"),d=t("../GameUtils"),h=t("../ToastManager"),f=t("./Item/ReadyAnimalItem"),m=t("./Item/ReadyToolItem"),y=cc._decorator,g=y.ccclass,_=y.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isPlayAni=!1,e.centerUI=null,e.uiRoot=null,e.diamond=null,e.animalPosRoot=null,e.animalRoot=null,e.animalPrefab=null,e.lastPageBtn=null,e.nextPageBtn=null,e.useAniIcon=null,e.chooseAniIcon=null,e.animName=null,e.animDesc=null,e.animScore=null,e.animLevel=null,e.animExpProgress=null,e.buyAnimRoot=null,e.animBuyCost=null,e.unLockInfoRoot=null,e.pagePointArr=[],e.toolsPosRoot=null,e.toolsRoot=null,e.toolPrefab=null,e.buyToolBtn=null,e.chooseToolIcon=null,e.toolDesc=null,e.animUIRoot=null,e.toolsUIRoot=null,e.btnStart=null,e.btnReady=null,e.showType=1,e.animalData=[],e.currentAnimalPage=0,e.chooseAnimID=-1,e}return i(e,t),e.prototype.onAwake=function(){this.isPlayAni=!1,this.chooseAnimID=p.default.instance.useAnimId,l.default.instance.on(r.ENUM_GAME_EVENT.UPDATE_DIAMOND_COUNT,this.initDiamond,this),l.default.instance.on(r.ENUM_GAME_EVENT.READYUI_CHOOSE_ITEM,this.initUseAnim,this),l.default.instance.on(r.ENUM_GAME_EVENT.READYUI_REFRESH_ITEM,this.initUseAnim,this),l.default.instance.on(r.ENUM_GAME_EVENT.READYUI_CHOOSE_TOOLITEM,this.initUseTool,this),l.default.instance.on(r.ENUM_GAME_EVENT.READYUI_REFRESH_TOOLITEM,this.initUseTool,this),this.startAnim(),this.initAnimalUI(),this.initDiamond()},e.prototype.initDiamond=function(){this.diamond.string=d.default.formatNumber(p.default.instance.diamond)},e.prototype.initAnimalUI=function(){var t=this;this.showType=1,this.animUIRoot.active=!0,this.toolsUIRoot.active=!1,this.btnReady.active=!0,this.btnStart.active=!1,this.animalData=[],this.currentAnimalPage=0,p.default.instance.animalData.forEach(function(e,n){var o=Math.floor(n/t.animalPosRoot.childrenCount);t.animalData[o]?t.animalData[o].push(e):(t.animalData[o]=[],t.animalData[o].push(e)),o=null}),this.showPage(this.currentAnimalPage)},e.prototype.showPage=function(t){this.animalRoot.removeAllChildren(),this.pagePointArr.forEach(function(e,n){e.active=n==t}),this.nextPageBtn.active=t<this.animalData.length-1,this.lastPageBtn.active=t>0;for(var e=0;e<this.animalData[t].length;e++)if(cc.isValid(this.animalPosRoot.children[e])){var n=this.animalData[t][e],o=cc.instantiate(this.animalPrefab);o.parent=this.animalRoot,o.position=this.animalPosRoot.children[e].position,o.getComponent(f.default).init(n)}l.default.instance.emit(r.ENUM_GAME_EVENT.READYUI_CHOOSE_ITEM,this.chooseAnimID)},e.prototype.initToolUI=function(){this.showType=2,this.animUIRoot.active=!1,this.toolsUIRoot.active=!0,this.btnReady.active=!1,this.btnStart.active=!0,this.toolsRoot.removeAllChildren();for(var t=0;t<p.default.instance.toolData.length;t++){var e=p.default.instance.toolData[t],n=cc.instantiate(this.toolPrefab);n.parent=this.toolsRoot,n.position=this.toolsPosRoot.children[t].position,n.getComponent(m.default).init(e)}l.default.instance.emit(r.ENUM_GAME_EVENT.READYUI_CHOOSE_TOOLITEM,-1)},e.prototype.initUseAnim=function(t){var e=p.default.instance.getAnimalDataById(t);if(e){this.chooseAnimID=t;var n=r.ANIMAL_TYPE_TEXTUREURL[t];this.chooseAniIcon.setSprite(n),this.animName.string=e.name,this.animDesc.string=e.desc;var o=!e.isLock||0==e.lockMoney;this.buyAnimRoot.active=!o,this.unLockInfoRoot.active=o,o?(this.animExpProgress.fillRange=e.expValue,this.animLevel.string="\u7b49\u7ea7 "+e.level+"/"+c.AnimalMaxLevel,this.animScore.string=e.score+"",p.default.instance.useAnimId=t,this.useAniIcon.setSprite(n)):this.animBuyCost.string=""+e.lockMoney}},e.prototype.initUseTool=function(t){var e=p.default.instance.getToolDataById(t);if(!e)return this.buyToolBtn.active=!1,void(this.toolDesc.string=c.ToolTip);this.buyToolBtn.active=e.countNumber<=0;var n=r.TOOL_TYPE_TEXTUREURL[t];this.chooseToolIcon.setSprite(n),this.toolDesc.string=e.desc,p.default.instance.currentUseToolID=t},e.prototype.onBtnBuyAnimals=function(){if(!this.isPlayAni){var t=p.default.instance.getAnimalDataById(this.chooseAnimID);t&&t.isLock&&(p.default.instance.buyAnimal(this.chooseAnimID)?(s.default.instance.playSound(r.ENUM_AUDIO_CLIP.GETNEW),l.default.instance.emit(r.ENUM_GAME_EVENT.READYUI_REFRESH_ITEM,this.chooseAnimID),h.default.instance.show("\u8d2d\u4e70\u6210\u529f")):(s.default.instance.playSound(r.ENUM_AUDIO_CLIP.NOMONEY),h.default.instance.show("\u5b9d\u77f3\u6570\u91cf\u4e0d\u8db3")))}},e.prototype.onBtnBuyTools=function(){if(!this.isPlayAni){var t=p.default.instance.getToolDataById(p.default.instance.currentUseToolID);t&&t.countNumber<=0&&(p.default.instance.buyTool(p.default.instance.currentUseToolID)?(s.default.instance.playSound(r.ENUM_AUDIO_CLIP.GETNEW),l.default.instance.emit(r.ENUM_GAME_EVENT.READYUI_REFRESH_TOOLITEM,p.default.instance.currentUseToolID),h.default.instance.show("\u8d2d\u4e70\u6210\u529f")):(s.default.instance.playSound(r.ENUM_AUDIO_CLIP.NOMONEY),h.default.instance.show("\u5b9d\u77f3\u6570\u91cf\u4e0d\u8db3")))}},e.prototype.onBtnNextPage=function(){this.isPlayAni||this.currentAnimalPage>=this.animalData.length-1||(s.default.instance.playSound(r.ENUM_AUDIO_CLIP.PLAY),this.currentAnimalPage++,this.showPage(this.currentAnimalPage))},e.prototype.onBtnLastNextPage=function(){this.isPlayAni||this.currentAnimalPage<=0||(s.default.instance.playSound(r.ENUM_AUDIO_CLIP.PLAY),this.currentAnimalPage--,this.showPage(this.currentAnimalPage))},e.prototype.onBtnStartGame=function(){this.isPlayAni||(s.default.instance.playSound(r.ENUM_AUDIO_CLIP.PLAY),this.quitAnim())},e.prototype.onBtnSwitchToAnimal=function(){var t=this;this.isPlayAni||1!=this.showType&&(s.default.instance.playBtn(),this.btnReady.active=!0,this.btnStart.active=!1,this.switchAni(function(){t.initAnimalUI()}))},e.prototype.onBtnSwitchToTools=function(){var t=this;this.isPlayAni||2!=this.showType&&(s.default.instance.playSound(r.ENUM_AUDIO_CLIP.PLAY),this.showType=2,this.btnReady.active=!1,this.btnStart.active=!0,this.switchAni(function(){t.initToolUI()}))},e.prototype.onBtnSetting=function(){this.isPlayAni||(s.default.instance.playBtn(),u.default.instance.loadRes(r.GAME_Prefab.settingUI.url).then(function(t){var e=cc.instantiate(t);e.parent=cc.find("Canvas"),e.zIndex=r.GAME_Prefab.settingUI.zIndex}))},e.prototype.startAnim=function(){var t=this;this.uiRoot.stopAllActions(),this.isPlayAni=!0;var e=.5*cc.winSize.height+700;this.uiRoot.setPosition(cc.v3(0,e)),cc.tween(this.uiRoot).to(.3,{y:0},{easing:"quadIn"}).call(function(){t.isPlayAni=!1}).start()},e.prototype.switchAni=function(t,e){var n=this;void 0===e&&(e=!0),this.centerUI.stopAllActions(),this.isPlayAni=!0;var o=-cc.winSize.width-300,i=cc.winSize.width+300;cc.tween(this.centerUI).to(.3,{x:e?o:i}).to(0,{x:e?i:o}).call(function(){t&&t()}).to(.3,{x:0}).call(function(){n.isPlayAni=!1}).start()},e.prototype.quitAnim=function(){var t=this;this.node.stopAllActions(),this.isPlayAni=!0;var e=.5*cc.winSize.height+700;cc.tween(this.node).to(.5,{y:e},{easing:"quadOut"}).call(function(){cc.resources.release(r.GAME_Prefab.readyUI.url),t.node.destroy(),l.default.instance.emit(r.ENUM_GAME_EVENT.GAME_START)}).start()},e.prototype.onDestroy=function(){l.default.instance.off(r.ENUM_GAME_EVENT.READYUI_CHOOSE_ITEM,this.initUseAnim,this),l.default.instance.off(r.ENUM_GAME_EVENT.READYUI_REFRESH_ITEM,this.initUseAnim,this),l.default.instance.off(r.ENUM_GAME_EVENT.READYUI_CHOOSE_TOOLITEM,this.initUseTool,this),l.default.instance.off(r.ENUM_GAME_EVENT.READYUI_REFRESH_TOOLITEM,this.initUseTool,this),l.default.instance.off(r.ENUM_GAME_EVENT.UPDATE_DIAMOND_COUNT,this.initDiamond,this)},a([_(cc.Node)],e.prototype,"centerUI",void 0),a([_(cc.Node)],e.prototype,"uiRoot",void 0),a([_(cc.Label)],e.prototype,"diamond",void 0),a([_(cc.Node)],e.prototype,"animalPosRoot",void 0),a([_(cc.Node)],e.prototype,"animalRoot",void 0),a([_(cc.Prefab)],e.prototype,"animalPrefab",void 0),a([_(cc.Node)],e.prototype,"lastPageBtn",void 0),a([_(cc.Node)],e.prototype,"nextPageBtn",void 0),a([_(cc.Sprite)],e.prototype,"useAniIcon",void 0),a([_(cc.Sprite)],e.prototype,"chooseAniIcon",void 0),a([_(cc.Label)],e.prototype,"animName",void 0),a([_(cc.Label)],e.prototype,"animDesc",void 0),a([_(cc.Label)],e.prototype,"animScore",void 0),a([_(cc.Label)],e.prototype,"animLevel",void 0),a([_(cc.Sprite)],e.prototype,"animExpProgress",void 0),a([_(cc.Node)],e.prototype,"buyAnimRoot",void 0),a([_(cc.Label)],e.prototype,"animBuyCost",void 0),a([_(cc.Node)],e.prototype,"unLockInfoRoot",void 0),a([_(cc.Node)],e.prototype,"pagePointArr",void 0),a([_(cc.Node)],e.prototype,"toolsPosRoot",void 0),a([_(cc.Node)],e.prototype,"toolsRoot",void 0),a([_(cc.Prefab)],e.prototype,"toolPrefab",void 0),a([_(cc.Node)],e.prototype,"buyToolBtn",void 0),a([_(cc.Sprite)],e.prototype,"chooseToolIcon",void 0),a([_(cc.Label)],e.prototype,"toolDesc",void 0),a([_(cc.Node)],e.prototype,"animUIRoot",void 0),a([_(cc.Node)],e.prototype,"toolsUIRoot",void 0),a([_(cc.Node)],e.prototype,"btnStart",void 0),a([_(cc.Node)],e.prototype,"btnReady",void 0),a([g],e)}(cc.Component);n.default=v,cc._RF.pop()},{"../../Data/Enum":"Enum","../../Data/GameData":"GameData","../../Manager/AudioManager":"AudioManager","../../Manager/EventManager":"EventManager","../../Manager/ResManager":"ResManager","../DataManager":"DataManager","../GameUtils":"GameUtils","../ToastManager":"ToastManager","./Item/ReadyAnimalItem":"ReadyAnimalItem","./Item/ReadyToolItem":"ReadyToolItem"}],ResManager:[function(t,e,n){"use strict";cc._RF.push(e,"a7c84pJVFdH27jEvFPPottt","ResManager");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,a){function r(t){try{s(o.next(t))}catch(e){a(e)}}function c(t){try{s(o.throw(t))}catch(e){a(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(r,c)}s((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,i,a,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(t){return function(e){return s([t,e])}}function s(a){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(i=2&a[0]?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,o=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!(i=(i=r.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){r=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){r.label=a[1];break}if(6===a[0]&&r.label<i[1]){r.label=i[1],i=a;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(a);break}i[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(c){a=[6,c],o=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function t(){this.loadMap=new Map}return t.getInstance=function(){return null===this._instance&&(this._instance=new this),this._instance},Object.defineProperty(t,"instance",{get:function(){return this.getInstance()},enumerable:!1,configurable:!0}),t.prototype.loadRes=function(t){return o(this,void 0,Promise,function(){var e=this;return i(this,function(){return this.loadMap.has(t)?[2]:[2,new Promise(function(n,o){var i=cc.resources.get(t);if(i)return n(i);e.loadMap.set(t,1),cc.resources.load(t,function(i,a){i?o("loadRes fail"+i):(e.loadMap.delete(t),n(a))})})]})})},t._instance=null,t}();n.default=a,cc._RF.pop()},{}],ScoreUI:[function(t,e,n){"use strict";cc._RF.push(e,"e0135nRhnlOy4m5GeORRnrw","ScoreUI");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../Data/Enum"),c=t("../../Manager/AudioManager"),s=t("../../Manager/EventManager"),l=t("../DataManager"),u=cc._decorator,p=u.ccclass,d=u.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.baseScore=null,e.addScore=null,e.totalScore=null,e.historyMaxScore=null,e.diamond=null,e.animRoot1=null,e.animRoot2=null,e.animRoot3=null,e.isPlayAni=!1,e}return i(e,t),e.prototype.initUI=function(){this.addScore.node.parent.active=!1,this.baseScore.string="\u57fa\u7840\u5206\uff1a"+l.default.instance.currentScore,this.addScore.string="\u52a0\u6210\u5206\uff1a0",this.diamond.string=""+l.default.instance.diamond;var t=l.default.instance.currentScore+0;this.totalScore.string="\u603b\u5206\uff1a"+t,t>l.default.instance.maxScore&&(l.default.instance.maxScore=t),this.historyMaxScore.string="\u5386\u53f2\u6700\u9ad8\u5206\uff1a"+l.default.instance.maxScore,this.startAni()},e.prototype.onBtnPlayAgain=function(){var t=this;this.isPlayAni||(c.default.instance.playBtn(),this.quitAni(function(){s.default.instance.emit(r.ENUM_GAME_EVENT.GAME_START),t.node.destroy()}))},e.prototype.onBtnHome=function(){var t=this;this.isPlayAni||(c.default.instance.playBtn(),this.quitAni(function(){s.default.instance.emit(r.ENUM_GAME_EVENT.QUIT_GAME),t.node.destroy()}))},e.prototype.onBtnShare=function(){this.isPlayAni||c.default.instance.playBtn()},e.prototype.startAni=function(){var t=this;this.animRoot1.x=-750,this.animRoot2.x=-750,this.animRoot3.y=-cc.winSize.height/2-100,this.isPlayAni=!0,cc.tween(this.animRoot1).to(.2,{x:0}).start(),cc.tween(this.animRoot2).delay(.2).to(.2,{x:0}).start(),cc.tween(this.animRoot3).delay(.2).to(.2,{y:-450}).call(function(){t.isPlayAni=!1,t.addScore.node.parent.active=!0}).start()},e.prototype.quitAni=function(t){var e=this;this.isPlayAni=!0,cc.tween(this.animRoot1).delay(.2).call(function(){e.addScore.node.parent.active=!1}).to(.2,{y:cc.winSize.height/2+300}).call(function(){e.isPlayAni=!1,t&&t()}).start(),cc.tween(this.animRoot2).to(.2,{x:-750}).start(),cc.tween(this.animRoot3).to(.2,{y:-cc.winSize.height/2-100}).start()},e.prototype.onDestroy=function(){cc.resources.release(r.GAME_Prefab.scoreUI.url)},a([d(cc.Label)],e.prototype,"baseScore",void 0),a([d(cc.Label)],e.prototype,"addScore",void 0),a([d(cc.Label)],e.prototype,"totalScore",void 0),a([d(cc.Label)],e.prototype,"historyMaxScore",void 0),a([d(cc.Label)],e.prototype,"diamond",void 0),a([d(cc.Node)],e.prototype,"animRoot1",void 0),a([d(cc.Node)],e.prototype,"animRoot2",void 0),a([d(cc.Node)],e.prototype,"animRoot3",void 0),a([p],e)}(cc.Component);n.default=h,cc._RF.pop()},{"../../Data/Enum":"Enum","../../Manager/AudioManager":"AudioManager","../../Manager/EventManager":"EventManager","../DataManager":"DataManager"}],SettingUI:[function(t,e,n){"use strict";cc._RF.push(e,"c6fb4VnAytAgZWDIji7vaVh","SettingUI");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../Data/Enum"),c=t("../../Manager/AudioManager"),s=t("../DataManager"),l=cc._decorator,u=l.ccclass,p=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.effectCheck=null,e.musicCheck=null,e}return i(e,t),e.prototype.onLoad=function(){this.initUI()},e.prototype.initUI=function(){this.effectCheck.getChildByName("open").active=1==s.default.instance.effectValue,this.effectCheck.getChildByName("close").active=0==s.default.instance.effectValue,this.musicCheck.getChildByName("open").active=1==s.default.instance.musicValue,this.musicCheck.getChildByName("close").active=0==s.default.instance.musicValue},e.prototype.onBtnSettingEffect=function(){c.default.instance.playBtn(),s.default.instance.effectValue=1==s.default.instance.effectValue?0:1,this.initUI()},e.prototype.onBtnSettingMusic=function(){c.default.instance.playBtn(),s.default.instance.musicValue=1==s.default.instance.musicValue?0:1,this.initUI(),c.default.instance.playMusic()},e.prototype.onBtnClose=function(){c.default.instance.playBtn(),this.node.destroy(),cc.resources.release(r.GAME_Prefab.settingUI.url)},a([p(cc.Node)],e.prototype,"effectCheck",void 0),a([p(cc.Node)],e.prototype,"musicCheck",void 0),a([u],e)}(cc.Component);n.default=d,cc._RF.pop()},{"../../Data/Enum":"Enum","../../Manager/AudioManager":"AudioManager","../DataManager":"DataManager"}],SkeletonExt:[function(t,e){"use strict";cc._RF.push(e,"3b00e2Jeo5LrJlz8AFLe+FT","SkeletonExt"),cc._RF.pop()},{}],StartUI:[function(t,e,n){"use strict";cc._RF.push(e,"f14a3L4JpRBsbqJqH+rfB9P","StartUI");var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var c=t.length-1;c>=0;c--)(i=t[c])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=t("../../Data/Enum"),c=t("../../Manager/AudioManager"),s=cc._decorator,l=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.topUI=null,e.grassLeft=null,e.grassRight=null,e.startBtn=null,e.bottomUI=null,e.quitCB=null,e}return i(e,t),e.prototype.onLoad=function(){},e.prototype.onAwake=function(){this.dropAndBounce(this.topUI),this.grassAni(),this.startBtnAni(),c.default.instance.playMusic()},e.prototype.onQuit=function(){var t=this;this.topQuitAni(function(){cc.resources.release(r.GAME_Prefab.startUI.url),t.quitCB&&t.quitCB(),t.node.destroy()}),this.bottomQuitAni()},e.prototype.topQuitAni=function(t){this.topUI.stopAllActions();var e=.5*cc.winSize.height;cc.tween(this.topUI).to(.5,{y:e},{easing:"quadOut"}).call(function(){t&&t()}).start()},e.prototype.bottomQuitAni=function(){this.bottomUI.stopAllActions();var t=-.5*cc.winSize.height-200;cc.tween(this.bottomUI).to(.5,{y:t},{easing:"quadOut"}).start()},e.prototype.dropAndBounce=function(t){var e=.5*cc.winSize.height+200;t.setPosition(cc.v3(0,e)),t.stopAllActions(),cc.tween(t).to(.3,{y:200},{easing:"quadIn"}).to(.2,{y:250},{easing:"quadOut"}).to(.15,{y:200},{easing:"quadIn"}).to(.1,{y:200+50/3},{easing:"quadOut"}).to(.08,{y:200},{easing:"quadIn"}).start()},e.prototype.grassAni=function(){this.grassLeft.stopAllActions(),this.grassRight.stopAllActions(),cc.tween(this.grassLeft).repeatForever(cc.tween().to(1,{angle:2}).to(2,{angle:-2}).to(1,{angle:0})).start(),cc.tween(this.grassRight).repeatForever(cc.tween().to(1,{angle:2}).to(2,{angle:-2}).to(1,{angle:0})).start()},e.prototype.startBtnAni=function(){this.startBtn.active=!0,this.startBtn.y=-450,this.startBtn.opacity=255,this.startBtn.stopAllActions(),cc.tween(this.startBtn).repeatForever(cc.tween(this.startBtn).to(2,{opacity:0},{easing:"quadOut"}).to(2,{opacity:255},{easing:"quadIn"})).start()},e.prototype.onBtnStart=function(){c.default.instance.playBtn(),this.onQuit()},a([u(cc.Node)],e.prototype,"topUI",void 0),a([u(cc.Node)],e.prototype,"grassLeft",void 0),a([u(cc.Node)],e.prototype,"grassRight",void 0),a([u(cc.Node)],e.prototype,"startBtn",void 0),a([u(cc.Node)],e.prototype,"bottomUI",void 0),a([l],e)}(cc.Component);n.default=p,cc._RF.pop()},{"../../Data/Enum":"Enum","../../Manager/AudioManager":"AudioManager"}],ToastManager:[function(t,e,n){"use strict";cc._RF.push(e,"f206dFcwyRMv50Nnu3Ei0vO","ToastManager"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return t.getInstance=function(){return null===this._instance&&(this._instance=new this),this._instance},Object.defineProperty(t,"instance",{get:function(){return this.getInstance()},enumerable:!1,configurable:!0}),t.prototype.show=function(t,e){void 0===t&&(t="");var n=void 0===e?{}:e,o=n.gravity,i=void 0===o?"CENTER":o,a=n.duration,r=void 0===a?1:a,c=n.bg_color,s=void 0===c?cc.color(102,102,102,200):c,l=cc.director.getScene().getComponentInChildren(cc.Canvas),u=l.node.width,p=l.node.height,d=new cc.Node,h=new cc.Node,f=h.addComponent(cc.Label);f.horizontalAlign=cc.Label.HorizontalAlign.CENTER,f.verticalAlign=cc.Label.VerticalAlign.CENTER,f.fontSize=30,f.string=t,t.length*f.fontSize>3*u/5?(h.width=3*u/5,f.overflow=cc.Label.Overflow.RESIZE_HEIGHT):h.width=t.length*f.fontSize;var m=1+~~(t.length*f.fontSize/(3*u/5));h.height=f.fontSize*m;var y=d.addComponent(cc.Graphics);y.arc(-h.width/2,0,h.height/2+20,.5*Math.PI,1.5*Math.PI,!0),y.lineTo(h.width/2,-(h.height/2+20)),y.arc(h.width/2,0,h.height/2+20,1.5*Math.PI,.5*Math.PI,!0),y.lineTo(-h.width/2,h.height/2+20),y.fillColor=s,y.fill(),d.addChild(h),"CENTER"===i?(d.y=0,d.x=0):"TOP"===i?d.y=d.y+p/5*2:"BOTTOM"===i&&(d.y=d.y-p/5*2),d.group="gameUI",d.zIndex=999,l.node.addChild(d);var g=cc.callFunc(function(){d.destroy()}),_=cc.sequence(cc.moveBy(r,cc.v2(0,0)),cc.fadeOut(.3),g);cc.tween(d).then(_).start()},t._instance=null,t}();n.default=o,cc._RF.pop()},{}]},{},["SkeletonExt","Enum","GameData","AnimalChoose","AnimalCube","AnimalManager","DataManager","Game","GameUtils","Main","ToastManager","GameSettingUI","AnimalLevelItem","ReadyAnimalItem","ReadyToolItem","LevelShowUI","LoadSceneUI","LoadUI","MainBgUI","ReadyUI","ScoreUI","SettingUI","StartUI","AudioManager","EventManager","PoolManager","ResManager"]);